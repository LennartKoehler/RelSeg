graph():
    %x : torch.Tensor [num_users=1] = placeholder[target=x]
    %_0_conv_0_conv_module : [num_users=1] = call_module[target=0.conv.0.conv.module](args = (%x,), kwargs = {})
    %silu : [num_users=1] = call_function[target=torch.nn.functional.silu](args = (%_0_conv_0_conv_module,), kwargs = {inplace: False})
    %_0_conv_1_conv_module : [num_users=1] = call_module[target=0.conv.1.conv.module](args = (%silu,), kwargs = {})
    %silu_1 : [num_users=1] = call_function[target=torch.nn.functional.silu](args = (%_0_conv_1_conv_module,), kwargs = {inplace: False})
    %_0_conv_2_conv_module : [num_users=1] = call_module[target=0.conv.2.conv.module](args = (%silu_1,), kwargs = {})
    %silu_2 : [num_users=1] = call_function[target=torch.nn.functional.silu](args = (%_0_conv_2_conv_module,), kwargs = {inplace: False})
    %_0_conv_3_conv_module : [num_users=1] = call_module[target=0.conv.3.conv.module](args = (%silu_2,), kwargs = {})
    %silu_3 : [num_users=1] = call_function[target=torch.nn.functional.silu](args = (%_0_conv_3_conv_module,), kwargs = {inplace: False})
    %_0_conv_4_conv_module : [num_users=1] = call_module[target=0.conv.4.conv.module](args = (%silu_3,), kwargs = {})
    %silu_4 : [num_users=1] = call_function[target=torch.nn.functional.silu](args = (%_0_conv_4_conv_module,), kwargs = {inplace: False})
    %permute : [num_users=3] = call_method[target=permute](args = (%silu_4, 0, 2, 1), kwargs = {})
    %size : [num_users=3] = call_method[target=size](args = (%permute,), kwargs = {})
    %getitem : [num_users=2] = call_function[target=operator.getitem](args = (%size, 0), kwargs = {})
    %getitem_1 : [num_users=2] = call_function[target=operator.getitem](args = (%size, 1), kwargs = {})
    %getitem_2 : [num_users=0] = call_function[target=operator.getitem](args = (%size, 2), kwargs = {})
    %_0_transformer_encoder_0_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.0.self_attn.Wqkv.weight]
    %linear_epsilon : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%permute, %_0_transformer_encoder_0_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view : [num_users=3] = call_method[target=view](args = (%linear_epsilon, %getitem, %getitem_1, 3, 8, 64), kwargs = {})
    %getitem_3 : [num_users=3] = call_function[target=operator.getitem](args = (%view, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_4 : [num_users=3] = call_function[target=operator.getitem](args = (%view, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_5 : [num_users=1] = call_function[target=operator.getitem](args = (%view, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_1 : [num_users=1] = call_method[target=size](args = (%getitem_3,), kwargs = {})
    %getitem_6 : [num_users=1] = call_function[target=operator.getitem](args = (%size_1, 1), kwargs = {})
    %arange : [num_users=1] = call_function[target=torch.arange](args = (%getitem_6,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_0_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.0.self_attn.rotary_emb_flash.inv_freq]
    %getattr_1 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_0_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne : [num_users=0] = call_function[target=operator.ne](args = (%getattr_1, torch.float32), kwargs = {})
    %_tensor_constant0 : [num_users=1] = get_attr[target=_tensor_constant0]
    %outer : [num_users=2] = call_function[target=torch.outer](args = (%arange, %_tensor_constant0), kwargs = {})
    %cos : [num_users=1] = call_function[target=torch.cos](args = (%outer,), kwargs = {})
    %getattr_2 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_3, dtype), kwargs = {})
    %to : [num_users=1] = call_method[target=to](args = (%cos, %getattr_2), kwargs = {})
    %sin : [num_users=1] = call_function[target=torch.sin](args = (%outer,), kwargs = {})
    %to_1 : [num_users=1] = call_method[target=to](args = (%sin, %getattr_2), kwargs = {})
    %apply_rotary_emb_torch : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_3, %to, %to_1, False), kwargs = {})
    %size_2 : [num_users=1] = call_method[target=size](args = (%getitem_4,), kwargs = {})
    %getitem_7 : [num_users=1] = call_function[target=operator.getitem](args = (%size_2, 1), kwargs = {})
    %arange_1 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_7,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_3 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_0_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_1 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_3, torch.float32), kwargs = {})
    %_tensor_constant1 : [num_users=1] = get_attr[target=_tensor_constant1]
    %outer_1 : [num_users=2] = call_function[target=torch.outer](args = (%arange_1, %_tensor_constant1), kwargs = {})
    %cos_1 : [num_users=1] = call_function[target=torch.cos](args = (%outer_1,), kwargs = {})
    %getattr_4 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_4, dtype), kwargs = {})
    %to_2 : [num_users=1] = call_method[target=to](args = (%cos_1, %getattr_4), kwargs = {})
    %sin_1 : [num_users=1] = call_function[target=torch.sin](args = (%outer_1,), kwargs = {})
    %to_3 : [num_users=1] = call_method[target=to](args = (%sin_1, %getattr_4), kwargs = {})
    %apply_rotary_emb_torch_1 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_4, %to_2, %to_3, False), kwargs = {})
    %size_3 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch,), kwargs = {})
    %getitem_8 : [num_users=1] = call_function[target=operator.getitem](args = (%size_3, 1), kwargs = {})
    %full : [num_users=1] = call_function[target=torch.full](args = ((%getitem_8, %getitem_8),), kwargs = {fill_value: 1.0})
    %triu : [num_users=2] = call_function[target=torch.triu](args = (%full,), kwargs = {diagonal: -127})
    %tril : [num_users=1] = call_function[target=torch.tril](args = (%triu,), kwargs = {diagonal: 128})
    %mul : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu, %tril), kwargs = {})
    %to_4 : [num_users=1] = call_method[target=to](args = (%mul, torch.bool), kwargs = {})
    %getattr_5 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch, device), kwargs = {})
    %to_5 : [num_users=1] = call_method[target=to](args = (%to_4, %getattr_5), kwargs = {})
    %permute_1 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch, 0, 2, 1, 3), kwargs = {})
    %getitem_9 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_1, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_2 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_1, 0, 2, 1, 3), kwargs = {})
    %getitem_10 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_2, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_3 : [num_users=1] = call_method[target=permute](args = (%getitem_5, 0, 2, 1, 3), kwargs = {})
    %getitem_11 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_3, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_4 : [num_users=1] = call_method[target=size](args = (%getitem_9, -2), kwargs = {})
    %size_5 : [num_users=1] = call_method[target=size](args = (%getitem_10, -2), kwargs = {})
    %size_6 : [num_users=1] = call_method[target=size](args = (%getitem_9, -1), kwargs = {})
    %sqrt : [num_users=1] = call_function[target=math.sqrt](args = (%size_6,), kwargs = {})
    %truediv : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt), kwargs = {})
    %getattr_6 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_9, dtype), kwargs = {})
    %getattr_7 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_9, device), kwargs = {})
    %zeros : [num_users=2] = call_function[target=torch.zeros](args = (%size_4, %size_5), kwargs = {dtype: %getattr_6, device: %getattr_7})
    %logical_not : [num_users=1] = call_method[target=logical_not](args = (%to_5,), kwargs = {})
    %masked_fill_ : [num_users=0] = call_method[target=masked_fill_](args = (%zeros, %logical_not, -inf), kwargs = {})
    %transpose : [num_users=1] = call_method[target=transpose](args = (%getitem_10, -2, -1), kwargs = {})
    %matmul : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_9, %transpose), kwargs = {})
    %tensor : [num_users=1] = call_function[target=torch.tensor](args = (%truediv,), kwargs = {requires_grad: False})
    %mul_1 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul, %tensor), kwargs = {})
    %detach : [num_users=1] = call_method[target=detach](args = (%zeros,), kwargs = {})
    %add : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_1, %detach), kwargs = {})
    %softmax : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add,), kwargs = {dim: -1})
    %matmul_1 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax, %getitem_11), kwargs = {})
    %permute_4 : [num_users=1] = call_method[target=permute](args = (%matmul_1, 0, 1, 3, 2, 4), kwargs = {})
    %reshape : [num_users=1] = call_method[target=reshape](args = (%permute_4, %getitem, %getitem_1, 512), kwargs = {})
    %_0_transformer_encoder_0_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.0.self_attn.out_proj.weight]
    %_0_transformer_encoder_0_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.0.self_attn.out_proj.bias]
    %linear_epsilon_1 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape, %_0_transformer_encoder_0_self_attn_out_proj_weight, %_0_transformer_encoder_0_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_0_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.0.deepnorm_alpha]
    %detach_1 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_0_deepnorm_alpha,), kwargs = {})
    %mul_2 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_1, %permute), kwargs = {})
    %add_1 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_1, %mul_2), kwargs = {})
    %_0_transformer_encoder_0_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.0.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_1, %_0_transformer_encoder_0_norm1_scale, %_0_transformer_encoder_17_norm2_eps, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_0_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.0.ff.fc1.weight]
    %linear_epsilon_2 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom, %_0_transformer_encoder_0_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_2, 2), kwargs = {dim: -1})
    %getitem_12 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_13 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %mul_3 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_13, %getitem_12), kwargs = {})
    %mul_4 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_3, 1), kwargs = {})
    %neg : [num_users=1] = call_function[target=operator.neg](args = (%getitem_13,), kwargs = {})
    %exp : [num_users=1] = call_function[target=torch.exp](args = (%neg,), kwargs = {})
    %_tensor_constant2 : [num_users=1] = get_attr[target=_tensor_constant2]
    %add_2 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant2, %exp), kwargs = {})
    %truediv_1 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_4, %add_2), kwargs = {})
    %_0_transformer_encoder_0_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.0.ff.fc2.weight]
    %linear_epsilon_3 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_1, %_0_transformer_encoder_0_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_2 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_0_deepnorm_alpha,), kwargs = {})
    %mul_5 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_2, %rms_norm_identity_custom), kwargs = {})
    %add_3 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_3, %mul_5), kwargs = {})
    %_0_transformer_encoder_0_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.0.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_1 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_1 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_3, %_0_transformer_encoder_0_norm2_scale, %_0_transformer_encoder_17_norm2_eps_1, 512, -1.0, False), kwargs = {})
    %size_7 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_1,), kwargs = {})
    %getitem_14 : [num_users=2] = call_function[target=operator.getitem](args = (%size_7, 0), kwargs = {})
    %getitem_15 : [num_users=2] = call_function[target=operator.getitem](args = (%size_7, 1), kwargs = {})
    %getitem_16 : [num_users=0] = call_function[target=operator.getitem](args = (%size_7, 2), kwargs = {})
    %_0_transformer_encoder_1_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.1.self_attn.Wqkv.weight]
    %linear_epsilon_4 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_1, %_0_transformer_encoder_1_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_1 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_4, %getitem_14, %getitem_15, 3, 8, 64), kwargs = {})
    %getitem_17 : [num_users=3] = call_function[target=operator.getitem](args = (%view_1, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_18 : [num_users=3] = call_function[target=operator.getitem](args = (%view_1, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_19 : [num_users=1] = call_function[target=operator.getitem](args = (%view_1, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_8 : [num_users=1] = call_method[target=size](args = (%getitem_17,), kwargs = {})
    %getitem_20 : [num_users=1] = call_function[target=operator.getitem](args = (%size_8, 1), kwargs = {})
    %arange_2 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_20,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_1_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.1.self_attn.rotary_emb_flash.inv_freq]
    %getattr_8 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_1_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_2 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_8, torch.float32), kwargs = {})
    %_tensor_constant3 : [num_users=1] = get_attr[target=_tensor_constant3]
    %outer_2 : [num_users=2] = call_function[target=torch.outer](args = (%arange_2, %_tensor_constant3), kwargs = {})
    %cos_2 : [num_users=1] = call_function[target=torch.cos](args = (%outer_2,), kwargs = {})
    %getattr_9 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_17, dtype), kwargs = {})
    %to_6 : [num_users=1] = call_method[target=to](args = (%cos_2, %getattr_9), kwargs = {})
    %sin_2 : [num_users=1] = call_function[target=torch.sin](args = (%outer_2,), kwargs = {})
    %to_7 : [num_users=1] = call_method[target=to](args = (%sin_2, %getattr_9), kwargs = {})
    %apply_rotary_emb_torch_2 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_17, %to_6, %to_7, False), kwargs = {})
    %size_9 : [num_users=1] = call_method[target=size](args = (%getitem_18,), kwargs = {})
    %getitem_21 : [num_users=1] = call_function[target=operator.getitem](args = (%size_9, 1), kwargs = {})
    %arange_3 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_21,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_10 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_1_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_3 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_10, torch.float32), kwargs = {})
    %_tensor_constant4 : [num_users=1] = get_attr[target=_tensor_constant4]
    %outer_3 : [num_users=2] = call_function[target=torch.outer](args = (%arange_3, %_tensor_constant4), kwargs = {})
    %cos_3 : [num_users=1] = call_function[target=torch.cos](args = (%outer_3,), kwargs = {})
    %getattr_11 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_18, dtype), kwargs = {})
    %to_8 : [num_users=1] = call_method[target=to](args = (%cos_3, %getattr_11), kwargs = {})
    %sin_3 : [num_users=1] = call_function[target=torch.sin](args = (%outer_3,), kwargs = {})
    %to_9 : [num_users=1] = call_method[target=to](args = (%sin_3, %getattr_11), kwargs = {})
    %apply_rotary_emb_torch_3 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_18, %to_8, %to_9, False), kwargs = {})
    %size_10 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_2,), kwargs = {})
    %getitem_22 : [num_users=1] = call_function[target=operator.getitem](args = (%size_10, 1), kwargs = {})
    %full_1 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_22, %getitem_22),), kwargs = {fill_value: 1.0})
    %triu_1 : [num_users=2] = call_function[target=torch.triu](args = (%full_1,), kwargs = {diagonal: -127})
    %tril_1 : [num_users=1] = call_function[target=torch.tril](args = (%triu_1,), kwargs = {diagonal: 128})
    %mul_6 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_1, %tril_1), kwargs = {})
    %to_10 : [num_users=1] = call_method[target=to](args = (%mul_6, torch.bool), kwargs = {})
    %getattr_12 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_2, device), kwargs = {})
    %to_11 : [num_users=1] = call_method[target=to](args = (%to_10, %getattr_12), kwargs = {})
    %permute_5 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_2, 0, 2, 1, 3), kwargs = {})
    %getitem_23 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_5, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_6 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_3, 0, 2, 1, 3), kwargs = {})
    %getitem_24 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_6, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_7 : [num_users=1] = call_method[target=permute](args = (%getitem_19, 0, 2, 1, 3), kwargs = {})
    %getitem_25 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_7, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_11 : [num_users=1] = call_method[target=size](args = (%getitem_23, -2), kwargs = {})
    %size_12 : [num_users=1] = call_method[target=size](args = (%getitem_24, -2), kwargs = {})
    %size_13 : [num_users=1] = call_method[target=size](args = (%getitem_23, -1), kwargs = {})
    %sqrt_1 : [num_users=1] = call_function[target=math.sqrt](args = (%size_13,), kwargs = {})
    %truediv_2 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_1), kwargs = {})
    %getattr_13 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_23, dtype), kwargs = {})
    %getattr_14 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_23, device), kwargs = {})
    %zeros_1 : [num_users=2] = call_function[target=torch.zeros](args = (%size_11, %size_12), kwargs = {dtype: %getattr_13, device: %getattr_14})
    %logical_not_1 : [num_users=1] = call_method[target=logical_not](args = (%to_11,), kwargs = {})
    %masked_fill__1 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_1, %logical_not_1, -inf), kwargs = {})
    %transpose_1 : [num_users=1] = call_method[target=transpose](args = (%getitem_24, -2, -1), kwargs = {})
    %matmul_2 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_23, %transpose_1), kwargs = {})
    %tensor_1 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_2,), kwargs = {requires_grad: False})
    %mul_7 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_2, %tensor_1), kwargs = {})
    %detach_3 : [num_users=1] = call_method[target=detach](args = (%zeros_1,), kwargs = {})
    %add_4 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_7, %detach_3), kwargs = {})
    %softmax_1 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_4,), kwargs = {dim: -1})
    %matmul_3 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_1, %getitem_25), kwargs = {})
    %permute_8 : [num_users=1] = call_method[target=permute](args = (%matmul_3, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_1 : [num_users=1] = call_method[target=reshape](args = (%permute_8, %getitem_14, %getitem_15, 512), kwargs = {})
    %_0_transformer_encoder_1_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.1.self_attn.out_proj.weight]
    %_0_transformer_encoder_1_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.1.self_attn.out_proj.bias]
    %linear_epsilon_5 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_1, %_0_transformer_encoder_1_self_attn_out_proj_weight, %_0_transformer_encoder_1_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_1_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.1.deepnorm_alpha]
    %detach_4 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_1_deepnorm_alpha,), kwargs = {})
    %mul_8 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_4, %rms_norm_identity_custom_1), kwargs = {})
    %add_5 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_5, %mul_8), kwargs = {})
    %_0_transformer_encoder_1_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.1.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_2 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_2 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_5, %_0_transformer_encoder_1_norm1_scale, %_0_transformer_encoder_17_norm2_eps_2, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_1_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.1.ff.fc1.weight]
    %linear_epsilon_6 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_2, %_0_transformer_encoder_1_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_1 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_6, 2), kwargs = {dim: -1})
    %getitem_26 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_1, 0), kwargs = {})
    %getitem_27 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_1, 1), kwargs = {})
    %mul_9 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_27, %getitem_26), kwargs = {})
    %mul_10 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_9, 1), kwargs = {})
    %neg_1 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_27,), kwargs = {})
    %exp_1 : [num_users=1] = call_function[target=torch.exp](args = (%neg_1,), kwargs = {})
    %_tensor_constant5 : [num_users=1] = get_attr[target=_tensor_constant5]
    %add_6 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant5, %exp_1), kwargs = {})
    %truediv_3 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_10, %add_6), kwargs = {})
    %_0_transformer_encoder_1_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.1.ff.fc2.weight]
    %linear_epsilon_7 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_3, %_0_transformer_encoder_1_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_5 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_1_deepnorm_alpha,), kwargs = {})
    %mul_11 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_5, %rms_norm_identity_custom_2), kwargs = {})
    %add_7 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_7, %mul_11), kwargs = {})
    %_0_transformer_encoder_1_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.1.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_3 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_3 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_7, %_0_transformer_encoder_1_norm2_scale, %_0_transformer_encoder_17_norm2_eps_3, 512, -1.0, False), kwargs = {})
    %size_14 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_3,), kwargs = {})
    %getitem_28 : [num_users=2] = call_function[target=operator.getitem](args = (%size_14, 0), kwargs = {})
    %getitem_29 : [num_users=2] = call_function[target=operator.getitem](args = (%size_14, 1), kwargs = {})
    %getitem_30 : [num_users=0] = call_function[target=operator.getitem](args = (%size_14, 2), kwargs = {})
    %_0_transformer_encoder_2_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.2.self_attn.Wqkv.weight]
    %linear_epsilon_8 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_3, %_0_transformer_encoder_2_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_2 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_8, %getitem_28, %getitem_29, 3, 8, 64), kwargs = {})
    %getitem_31 : [num_users=3] = call_function[target=operator.getitem](args = (%view_2, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_32 : [num_users=3] = call_function[target=operator.getitem](args = (%view_2, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_33 : [num_users=1] = call_function[target=operator.getitem](args = (%view_2, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_15 : [num_users=1] = call_method[target=size](args = (%getitem_31,), kwargs = {})
    %getitem_34 : [num_users=1] = call_function[target=operator.getitem](args = (%size_15, 1), kwargs = {})
    %arange_4 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_34,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_2_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.2.self_attn.rotary_emb_flash.inv_freq]
    %getattr_15 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_2_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_4 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_15, torch.float32), kwargs = {})
    %_tensor_constant6 : [num_users=1] = get_attr[target=_tensor_constant6]
    %outer_4 : [num_users=2] = call_function[target=torch.outer](args = (%arange_4, %_tensor_constant6), kwargs = {})
    %cos_4 : [num_users=1] = call_function[target=torch.cos](args = (%outer_4,), kwargs = {})
    %getattr_16 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_31, dtype), kwargs = {})
    %to_12 : [num_users=1] = call_method[target=to](args = (%cos_4, %getattr_16), kwargs = {})
    %sin_4 : [num_users=1] = call_function[target=torch.sin](args = (%outer_4,), kwargs = {})
    %to_13 : [num_users=1] = call_method[target=to](args = (%sin_4, %getattr_16), kwargs = {})
    %apply_rotary_emb_torch_4 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_31, %to_12, %to_13, False), kwargs = {})
    %size_16 : [num_users=1] = call_method[target=size](args = (%getitem_32,), kwargs = {})
    %getitem_35 : [num_users=1] = call_function[target=operator.getitem](args = (%size_16, 1), kwargs = {})
    %arange_5 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_35,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_17 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_2_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_5 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_17, torch.float32), kwargs = {})
    %_tensor_constant7 : [num_users=1] = get_attr[target=_tensor_constant7]
    %outer_5 : [num_users=2] = call_function[target=torch.outer](args = (%arange_5, %_tensor_constant7), kwargs = {})
    %cos_5 : [num_users=1] = call_function[target=torch.cos](args = (%outer_5,), kwargs = {})
    %getattr_18 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_32, dtype), kwargs = {})
    %to_14 : [num_users=1] = call_method[target=to](args = (%cos_5, %getattr_18), kwargs = {})
    %sin_5 : [num_users=1] = call_function[target=torch.sin](args = (%outer_5,), kwargs = {})
    %to_15 : [num_users=1] = call_method[target=to](args = (%sin_5, %getattr_18), kwargs = {})
    %apply_rotary_emb_torch_5 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_32, %to_14, %to_15, False), kwargs = {})
    %size_17 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_4,), kwargs = {})
    %getitem_36 : [num_users=1] = call_function[target=operator.getitem](args = (%size_17, 1), kwargs = {})
    %full_2 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_36, %getitem_36),), kwargs = {fill_value: 1.0})
    %triu_2 : [num_users=2] = call_function[target=torch.triu](args = (%full_2,), kwargs = {diagonal: -127})
    %tril_2 : [num_users=1] = call_function[target=torch.tril](args = (%triu_2,), kwargs = {diagonal: 128})
    %mul_12 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_2, %tril_2), kwargs = {})
    %to_16 : [num_users=1] = call_method[target=to](args = (%mul_12, torch.bool), kwargs = {})
    %getattr_19 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_4, device), kwargs = {})
    %to_17 : [num_users=1] = call_method[target=to](args = (%to_16, %getattr_19), kwargs = {})
    %permute_9 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_4, 0, 2, 1, 3), kwargs = {})
    %getitem_37 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_9, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_10 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_5, 0, 2, 1, 3), kwargs = {})
    %getitem_38 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_10, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_11 : [num_users=1] = call_method[target=permute](args = (%getitem_33, 0, 2, 1, 3), kwargs = {})
    %getitem_39 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_11, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_18 : [num_users=1] = call_method[target=size](args = (%getitem_37, -2), kwargs = {})
    %size_19 : [num_users=1] = call_method[target=size](args = (%getitem_38, -2), kwargs = {})
    %size_20 : [num_users=1] = call_method[target=size](args = (%getitem_37, -1), kwargs = {})
    %sqrt_2 : [num_users=1] = call_function[target=math.sqrt](args = (%size_20,), kwargs = {})
    %truediv_4 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_2), kwargs = {})
    %getattr_20 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_37, dtype), kwargs = {})
    %getattr_21 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_37, device), kwargs = {})
    %zeros_2 : [num_users=2] = call_function[target=torch.zeros](args = (%size_18, %size_19), kwargs = {dtype: %getattr_20, device: %getattr_21})
    %logical_not_2 : [num_users=1] = call_method[target=logical_not](args = (%to_17,), kwargs = {})
    %masked_fill__2 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_2, %logical_not_2, -inf), kwargs = {})
    %transpose_2 : [num_users=1] = call_method[target=transpose](args = (%getitem_38, -2, -1), kwargs = {})
    %matmul_4 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_37, %transpose_2), kwargs = {})
    %tensor_2 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_4,), kwargs = {requires_grad: False})
    %mul_13 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_4, %tensor_2), kwargs = {})
    %detach_6 : [num_users=1] = call_method[target=detach](args = (%zeros_2,), kwargs = {})
    %add_8 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_13, %detach_6), kwargs = {})
    %softmax_2 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_8,), kwargs = {dim: -1})
    %matmul_5 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_2, %getitem_39), kwargs = {})
    %permute_12 : [num_users=1] = call_method[target=permute](args = (%matmul_5, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_2 : [num_users=1] = call_method[target=reshape](args = (%permute_12, %getitem_28, %getitem_29, 512), kwargs = {})
    %_0_transformer_encoder_2_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.2.self_attn.out_proj.weight]
    %_0_transformer_encoder_2_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.2.self_attn.out_proj.bias]
    %linear_epsilon_9 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_2, %_0_transformer_encoder_2_self_attn_out_proj_weight, %_0_transformer_encoder_2_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_2_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.2.deepnorm_alpha]
    %detach_7 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_2_deepnorm_alpha,), kwargs = {})
    %mul_14 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_7, %rms_norm_identity_custom_3), kwargs = {})
    %add_9 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_9, %mul_14), kwargs = {})
    %_0_transformer_encoder_2_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.2.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_4 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_4 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_9, %_0_transformer_encoder_2_norm1_scale, %_0_transformer_encoder_17_norm2_eps_4, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_2_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.2.ff.fc1.weight]
    %linear_epsilon_10 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_4, %_0_transformer_encoder_2_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_2 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_10, 2), kwargs = {dim: -1})
    %getitem_40 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_2, 0), kwargs = {})
    %getitem_41 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_2, 1), kwargs = {})
    %mul_15 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_41, %getitem_40), kwargs = {})
    %mul_16 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_15, 1), kwargs = {})
    %neg_2 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_41,), kwargs = {})
    %exp_2 : [num_users=1] = call_function[target=torch.exp](args = (%neg_2,), kwargs = {})
    %_tensor_constant8 : [num_users=1] = get_attr[target=_tensor_constant8]
    %add_10 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant8, %exp_2), kwargs = {})
    %truediv_5 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_16, %add_10), kwargs = {})
    %_0_transformer_encoder_2_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.2.ff.fc2.weight]
    %linear_epsilon_11 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_5, %_0_transformer_encoder_2_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_8 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_2_deepnorm_alpha,), kwargs = {})
    %mul_17 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_8, %rms_norm_identity_custom_4), kwargs = {})
    %add_11 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_11, %mul_17), kwargs = {})
    %_0_transformer_encoder_2_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.2.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_5 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_5 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_11, %_0_transformer_encoder_2_norm2_scale, %_0_transformer_encoder_17_norm2_eps_5, 512, -1.0, False), kwargs = {})
    %size_21 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_5,), kwargs = {})
    %getitem_42 : [num_users=2] = call_function[target=operator.getitem](args = (%size_21, 0), kwargs = {})
    %getitem_43 : [num_users=2] = call_function[target=operator.getitem](args = (%size_21, 1), kwargs = {})
    %getitem_44 : [num_users=0] = call_function[target=operator.getitem](args = (%size_21, 2), kwargs = {})
    %_0_transformer_encoder_3_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.3.self_attn.Wqkv.weight]
    %linear_epsilon_12 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_5, %_0_transformer_encoder_3_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_3 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_12, %getitem_42, %getitem_43, 3, 8, 64), kwargs = {})
    %getitem_45 : [num_users=3] = call_function[target=operator.getitem](args = (%view_3, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_46 : [num_users=3] = call_function[target=operator.getitem](args = (%view_3, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_47 : [num_users=1] = call_function[target=operator.getitem](args = (%view_3, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_22 : [num_users=1] = call_method[target=size](args = (%getitem_45,), kwargs = {})
    %getitem_48 : [num_users=1] = call_function[target=operator.getitem](args = (%size_22, 1), kwargs = {})
    %arange_6 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_48,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_3_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.3.self_attn.rotary_emb_flash.inv_freq]
    %getattr_22 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_3_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_6 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_22, torch.float32), kwargs = {})
    %_tensor_constant9 : [num_users=1] = get_attr[target=_tensor_constant9]
    %outer_6 : [num_users=2] = call_function[target=torch.outer](args = (%arange_6, %_tensor_constant9), kwargs = {})
    %cos_6 : [num_users=1] = call_function[target=torch.cos](args = (%outer_6,), kwargs = {})
    %getattr_23 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_45, dtype), kwargs = {})
    %to_18 : [num_users=1] = call_method[target=to](args = (%cos_6, %getattr_23), kwargs = {})
    %sin_6 : [num_users=1] = call_function[target=torch.sin](args = (%outer_6,), kwargs = {})
    %to_19 : [num_users=1] = call_method[target=to](args = (%sin_6, %getattr_23), kwargs = {})
    %apply_rotary_emb_torch_6 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_45, %to_18, %to_19, False), kwargs = {})
    %size_23 : [num_users=1] = call_method[target=size](args = (%getitem_46,), kwargs = {})
    %getitem_49 : [num_users=1] = call_function[target=operator.getitem](args = (%size_23, 1), kwargs = {})
    %arange_7 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_49,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_24 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_3_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_7 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_24, torch.float32), kwargs = {})
    %_tensor_constant10 : [num_users=1] = get_attr[target=_tensor_constant10]
    %outer_7 : [num_users=2] = call_function[target=torch.outer](args = (%arange_7, %_tensor_constant10), kwargs = {})
    %cos_7 : [num_users=1] = call_function[target=torch.cos](args = (%outer_7,), kwargs = {})
    %getattr_25 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_46, dtype), kwargs = {})
    %to_20 : [num_users=1] = call_method[target=to](args = (%cos_7, %getattr_25), kwargs = {})
    %sin_7 : [num_users=1] = call_function[target=torch.sin](args = (%outer_7,), kwargs = {})
    %to_21 : [num_users=1] = call_method[target=to](args = (%sin_7, %getattr_25), kwargs = {})
    %apply_rotary_emb_torch_7 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_46, %to_20, %to_21, False), kwargs = {})
    %size_24 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_6,), kwargs = {})
    %getitem_50 : [num_users=1] = call_function[target=operator.getitem](args = (%size_24, 1), kwargs = {})
    %full_3 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_50, %getitem_50),), kwargs = {fill_value: 1.0})
    %triu_3 : [num_users=2] = call_function[target=torch.triu](args = (%full_3,), kwargs = {diagonal: -127})
    %tril_3 : [num_users=1] = call_function[target=torch.tril](args = (%triu_3,), kwargs = {diagonal: 128})
    %mul_18 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_3, %tril_3), kwargs = {})
    %to_22 : [num_users=1] = call_method[target=to](args = (%mul_18, torch.bool), kwargs = {})
    %getattr_26 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_6, device), kwargs = {})
    %to_23 : [num_users=1] = call_method[target=to](args = (%to_22, %getattr_26), kwargs = {})
    %permute_13 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_6, 0, 2, 1, 3), kwargs = {})
    %getitem_51 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_13, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_14 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_7, 0, 2, 1, 3), kwargs = {})
    %getitem_52 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_14, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_15 : [num_users=1] = call_method[target=permute](args = (%getitem_47, 0, 2, 1, 3), kwargs = {})
    %getitem_53 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_15, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_25 : [num_users=1] = call_method[target=size](args = (%getitem_51, -2), kwargs = {})
    %size_26 : [num_users=1] = call_method[target=size](args = (%getitem_52, -2), kwargs = {})
    %size_27 : [num_users=1] = call_method[target=size](args = (%getitem_51, -1), kwargs = {})
    %sqrt_3 : [num_users=1] = call_function[target=math.sqrt](args = (%size_27,), kwargs = {})
    %truediv_6 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_3), kwargs = {})
    %getattr_27 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_51, dtype), kwargs = {})
    %getattr_28 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_51, device), kwargs = {})
    %zeros_3 : [num_users=2] = call_function[target=torch.zeros](args = (%size_25, %size_26), kwargs = {dtype: %getattr_27, device: %getattr_28})
    %logical_not_3 : [num_users=1] = call_method[target=logical_not](args = (%to_23,), kwargs = {})
    %masked_fill__3 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_3, %logical_not_3, -inf), kwargs = {})
    %transpose_3 : [num_users=1] = call_method[target=transpose](args = (%getitem_52, -2, -1), kwargs = {})
    %matmul_6 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_51, %transpose_3), kwargs = {})
    %tensor_3 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_6,), kwargs = {requires_grad: False})
    %mul_19 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_6, %tensor_3), kwargs = {})
    %detach_9 : [num_users=1] = call_method[target=detach](args = (%zeros_3,), kwargs = {})
    %add_12 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_19, %detach_9), kwargs = {})
    %softmax_3 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_12,), kwargs = {dim: -1})
    %matmul_7 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_3, %getitem_53), kwargs = {})
    %permute_16 : [num_users=1] = call_method[target=permute](args = (%matmul_7, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_3 : [num_users=1] = call_method[target=reshape](args = (%permute_16, %getitem_42, %getitem_43, 512), kwargs = {})
    %_0_transformer_encoder_3_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.3.self_attn.out_proj.weight]
    %_0_transformer_encoder_3_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.3.self_attn.out_proj.bias]
    %linear_epsilon_13 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_3, %_0_transformer_encoder_3_self_attn_out_proj_weight, %_0_transformer_encoder_3_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_3_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.3.deepnorm_alpha]
    %detach_10 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_3_deepnorm_alpha,), kwargs = {})
    %mul_20 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_10, %rms_norm_identity_custom_5), kwargs = {})
    %add_13 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_13, %mul_20), kwargs = {})
    %_0_transformer_encoder_3_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.3.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_6 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_6 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_13, %_0_transformer_encoder_3_norm1_scale, %_0_transformer_encoder_17_norm2_eps_6, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_3_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.3.ff.fc1.weight]
    %linear_epsilon_14 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_6, %_0_transformer_encoder_3_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_3 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_14, 2), kwargs = {dim: -1})
    %getitem_54 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_3, 0), kwargs = {})
    %getitem_55 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_3, 1), kwargs = {})
    %mul_21 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_55, %getitem_54), kwargs = {})
    %mul_22 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_21, 1), kwargs = {})
    %neg_3 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_55,), kwargs = {})
    %exp_3 : [num_users=1] = call_function[target=torch.exp](args = (%neg_3,), kwargs = {})
    %_tensor_constant11 : [num_users=1] = get_attr[target=_tensor_constant11]
    %add_14 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant11, %exp_3), kwargs = {})
    %truediv_7 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_22, %add_14), kwargs = {})
    %_0_transformer_encoder_3_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.3.ff.fc2.weight]
    %linear_epsilon_15 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_7, %_0_transformer_encoder_3_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_11 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_3_deepnorm_alpha,), kwargs = {})
    %mul_23 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_11, %rms_norm_identity_custom_6), kwargs = {})
    %add_15 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_15, %mul_23), kwargs = {})
    %_0_transformer_encoder_3_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.3.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_7 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_7 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_15, %_0_transformer_encoder_3_norm2_scale, %_0_transformer_encoder_17_norm2_eps_7, 512, -1.0, False), kwargs = {})
    %size_28 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_7,), kwargs = {})
    %getitem_56 : [num_users=2] = call_function[target=operator.getitem](args = (%size_28, 0), kwargs = {})
    %getitem_57 : [num_users=2] = call_function[target=operator.getitem](args = (%size_28, 1), kwargs = {})
    %getitem_58 : [num_users=0] = call_function[target=operator.getitem](args = (%size_28, 2), kwargs = {})
    %_0_transformer_encoder_4_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.4.self_attn.Wqkv.weight]
    %linear_epsilon_16 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_7, %_0_transformer_encoder_4_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_4 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_16, %getitem_56, %getitem_57, 3, 8, 64), kwargs = {})
    %getitem_59 : [num_users=3] = call_function[target=operator.getitem](args = (%view_4, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_60 : [num_users=3] = call_function[target=operator.getitem](args = (%view_4, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_61 : [num_users=1] = call_function[target=operator.getitem](args = (%view_4, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_29 : [num_users=1] = call_method[target=size](args = (%getitem_59,), kwargs = {})
    %getitem_62 : [num_users=1] = call_function[target=operator.getitem](args = (%size_29, 1), kwargs = {})
    %arange_8 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_62,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_4_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.4.self_attn.rotary_emb_flash.inv_freq]
    %getattr_29 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_4_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_8 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_29, torch.float32), kwargs = {})
    %_tensor_constant12 : [num_users=1] = get_attr[target=_tensor_constant12]
    %outer_8 : [num_users=2] = call_function[target=torch.outer](args = (%arange_8, %_tensor_constant12), kwargs = {})
    %cos_8 : [num_users=1] = call_function[target=torch.cos](args = (%outer_8,), kwargs = {})
    %getattr_30 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_59, dtype), kwargs = {})
    %to_24 : [num_users=1] = call_method[target=to](args = (%cos_8, %getattr_30), kwargs = {})
    %sin_8 : [num_users=1] = call_function[target=torch.sin](args = (%outer_8,), kwargs = {})
    %to_25 : [num_users=1] = call_method[target=to](args = (%sin_8, %getattr_30), kwargs = {})
    %apply_rotary_emb_torch_8 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_59, %to_24, %to_25, False), kwargs = {})
    %size_30 : [num_users=1] = call_method[target=size](args = (%getitem_60,), kwargs = {})
    %getitem_63 : [num_users=1] = call_function[target=operator.getitem](args = (%size_30, 1), kwargs = {})
    %arange_9 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_63,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_31 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_4_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_9 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_31, torch.float32), kwargs = {})
    %_tensor_constant13 : [num_users=1] = get_attr[target=_tensor_constant13]
    %outer_9 : [num_users=2] = call_function[target=torch.outer](args = (%arange_9, %_tensor_constant13), kwargs = {})
    %cos_9 : [num_users=1] = call_function[target=torch.cos](args = (%outer_9,), kwargs = {})
    %getattr_32 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_60, dtype), kwargs = {})
    %to_26 : [num_users=1] = call_method[target=to](args = (%cos_9, %getattr_32), kwargs = {})
    %sin_9 : [num_users=1] = call_function[target=torch.sin](args = (%outer_9,), kwargs = {})
    %to_27 : [num_users=1] = call_method[target=to](args = (%sin_9, %getattr_32), kwargs = {})
    %apply_rotary_emb_torch_9 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_60, %to_26, %to_27, False), kwargs = {})
    %size_31 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_8,), kwargs = {})
    %getitem_64 : [num_users=1] = call_function[target=operator.getitem](args = (%size_31, 1), kwargs = {})
    %full_4 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_64, %getitem_64),), kwargs = {fill_value: 1.0})
    %triu_4 : [num_users=2] = call_function[target=torch.triu](args = (%full_4,), kwargs = {diagonal: -127})
    %tril_4 : [num_users=1] = call_function[target=torch.tril](args = (%triu_4,), kwargs = {diagonal: 128})
    %mul_24 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_4, %tril_4), kwargs = {})
    %to_28 : [num_users=1] = call_method[target=to](args = (%mul_24, torch.bool), kwargs = {})
    %getattr_33 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_8, device), kwargs = {})
    %to_29 : [num_users=1] = call_method[target=to](args = (%to_28, %getattr_33), kwargs = {})
    %permute_17 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_8, 0, 2, 1, 3), kwargs = {})
    %getitem_65 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_17, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_18 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_9, 0, 2, 1, 3), kwargs = {})
    %getitem_66 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_18, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_19 : [num_users=1] = call_method[target=permute](args = (%getitem_61, 0, 2, 1, 3), kwargs = {})
    %getitem_67 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_19, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_32 : [num_users=1] = call_method[target=size](args = (%getitem_65, -2), kwargs = {})
    %size_33 : [num_users=1] = call_method[target=size](args = (%getitem_66, -2), kwargs = {})
    %size_34 : [num_users=1] = call_method[target=size](args = (%getitem_65, -1), kwargs = {})
    %sqrt_4 : [num_users=1] = call_function[target=math.sqrt](args = (%size_34,), kwargs = {})
    %truediv_8 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_4), kwargs = {})
    %getattr_34 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_65, dtype), kwargs = {})
    %getattr_35 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_65, device), kwargs = {})
    %zeros_4 : [num_users=2] = call_function[target=torch.zeros](args = (%size_32, %size_33), kwargs = {dtype: %getattr_34, device: %getattr_35})
    %logical_not_4 : [num_users=1] = call_method[target=logical_not](args = (%to_29,), kwargs = {})
    %masked_fill__4 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_4, %logical_not_4, -inf), kwargs = {})
    %transpose_4 : [num_users=1] = call_method[target=transpose](args = (%getitem_66, -2, -1), kwargs = {})
    %matmul_8 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_65, %transpose_4), kwargs = {})
    %tensor_4 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_8,), kwargs = {requires_grad: False})
    %mul_25 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_8, %tensor_4), kwargs = {})
    %detach_12 : [num_users=1] = call_method[target=detach](args = (%zeros_4,), kwargs = {})
    %add_16 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_25, %detach_12), kwargs = {})
    %softmax_4 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_16,), kwargs = {dim: -1})
    %matmul_9 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_4, %getitem_67), kwargs = {})
    %permute_20 : [num_users=1] = call_method[target=permute](args = (%matmul_9, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_4 : [num_users=1] = call_method[target=reshape](args = (%permute_20, %getitem_56, %getitem_57, 512), kwargs = {})
    %_0_transformer_encoder_4_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.4.self_attn.out_proj.weight]
    %_0_transformer_encoder_4_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.4.self_attn.out_proj.bias]
    %linear_epsilon_17 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_4, %_0_transformer_encoder_4_self_attn_out_proj_weight, %_0_transformer_encoder_4_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_4_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.4.deepnorm_alpha]
    %detach_13 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_4_deepnorm_alpha,), kwargs = {})
    %mul_26 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_13, %rms_norm_identity_custom_7), kwargs = {})
    %add_17 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_17, %mul_26), kwargs = {})
    %_0_transformer_encoder_4_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.4.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_8 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_8 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_17, %_0_transformer_encoder_4_norm1_scale, %_0_transformer_encoder_17_norm2_eps_8, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_4_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.4.ff.fc1.weight]
    %linear_epsilon_18 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_8, %_0_transformer_encoder_4_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_4 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_18, 2), kwargs = {dim: -1})
    %getitem_68 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_4, 0), kwargs = {})
    %getitem_69 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_4, 1), kwargs = {})
    %mul_27 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_69, %getitem_68), kwargs = {})
    %mul_28 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_27, 1), kwargs = {})
    %neg_4 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_69,), kwargs = {})
    %exp_4 : [num_users=1] = call_function[target=torch.exp](args = (%neg_4,), kwargs = {})
    %_tensor_constant14 : [num_users=1] = get_attr[target=_tensor_constant14]
    %add_18 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant14, %exp_4), kwargs = {})
    %truediv_9 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_28, %add_18), kwargs = {})
    %_0_transformer_encoder_4_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.4.ff.fc2.weight]
    %linear_epsilon_19 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_9, %_0_transformer_encoder_4_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_14 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_4_deepnorm_alpha,), kwargs = {})
    %mul_29 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_14, %rms_norm_identity_custom_8), kwargs = {})
    %add_19 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_19, %mul_29), kwargs = {})
    %_0_transformer_encoder_4_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.4.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_9 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_9 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_19, %_0_transformer_encoder_4_norm2_scale, %_0_transformer_encoder_17_norm2_eps_9, 512, -1.0, False), kwargs = {})
    %size_35 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_9,), kwargs = {})
    %getitem_70 : [num_users=2] = call_function[target=operator.getitem](args = (%size_35, 0), kwargs = {})
    %getitem_71 : [num_users=2] = call_function[target=operator.getitem](args = (%size_35, 1), kwargs = {})
    %getitem_72 : [num_users=0] = call_function[target=operator.getitem](args = (%size_35, 2), kwargs = {})
    %_0_transformer_encoder_5_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.5.self_attn.Wqkv.weight]
    %linear_epsilon_20 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_9, %_0_transformer_encoder_5_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_5 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_20, %getitem_70, %getitem_71, 3, 8, 64), kwargs = {})
    %getitem_73 : [num_users=3] = call_function[target=operator.getitem](args = (%view_5, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_74 : [num_users=3] = call_function[target=operator.getitem](args = (%view_5, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_75 : [num_users=1] = call_function[target=operator.getitem](args = (%view_5, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_36 : [num_users=1] = call_method[target=size](args = (%getitem_73,), kwargs = {})
    %getitem_76 : [num_users=1] = call_function[target=operator.getitem](args = (%size_36, 1), kwargs = {})
    %arange_10 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_76,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_5_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.5.self_attn.rotary_emb_flash.inv_freq]
    %getattr_36 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_5_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_10 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_36, torch.float32), kwargs = {})
    %_tensor_constant15 : [num_users=1] = get_attr[target=_tensor_constant15]
    %outer_10 : [num_users=2] = call_function[target=torch.outer](args = (%arange_10, %_tensor_constant15), kwargs = {})
    %cos_10 : [num_users=1] = call_function[target=torch.cos](args = (%outer_10,), kwargs = {})
    %getattr_37 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_73, dtype), kwargs = {})
    %to_30 : [num_users=1] = call_method[target=to](args = (%cos_10, %getattr_37), kwargs = {})
    %sin_10 : [num_users=1] = call_function[target=torch.sin](args = (%outer_10,), kwargs = {})
    %to_31 : [num_users=1] = call_method[target=to](args = (%sin_10, %getattr_37), kwargs = {})
    %apply_rotary_emb_torch_10 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_73, %to_30, %to_31, False), kwargs = {})
    %size_37 : [num_users=1] = call_method[target=size](args = (%getitem_74,), kwargs = {})
    %getitem_77 : [num_users=1] = call_function[target=operator.getitem](args = (%size_37, 1), kwargs = {})
    %arange_11 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_77,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_38 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_5_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_11 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_38, torch.float32), kwargs = {})
    %_tensor_constant16 : [num_users=1] = get_attr[target=_tensor_constant16]
    %outer_11 : [num_users=2] = call_function[target=torch.outer](args = (%arange_11, %_tensor_constant16), kwargs = {})
    %cos_11 : [num_users=1] = call_function[target=torch.cos](args = (%outer_11,), kwargs = {})
    %getattr_39 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_74, dtype), kwargs = {})
    %to_32 : [num_users=1] = call_method[target=to](args = (%cos_11, %getattr_39), kwargs = {})
    %sin_11 : [num_users=1] = call_function[target=torch.sin](args = (%outer_11,), kwargs = {})
    %to_33 : [num_users=1] = call_method[target=to](args = (%sin_11, %getattr_39), kwargs = {})
    %apply_rotary_emb_torch_11 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_74, %to_32, %to_33, False), kwargs = {})
    %size_38 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_10,), kwargs = {})
    %getitem_78 : [num_users=1] = call_function[target=operator.getitem](args = (%size_38, 1), kwargs = {})
    %full_5 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_78, %getitem_78),), kwargs = {fill_value: 1.0})
    %triu_5 : [num_users=2] = call_function[target=torch.triu](args = (%full_5,), kwargs = {diagonal: -127})
    %tril_5 : [num_users=1] = call_function[target=torch.tril](args = (%triu_5,), kwargs = {diagonal: 128})
    %mul_30 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_5, %tril_5), kwargs = {})
    %to_34 : [num_users=1] = call_method[target=to](args = (%mul_30, torch.bool), kwargs = {})
    %getattr_40 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_10, device), kwargs = {})
    %to_35 : [num_users=1] = call_method[target=to](args = (%to_34, %getattr_40), kwargs = {})
    %permute_21 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_10, 0, 2, 1, 3), kwargs = {})
    %getitem_79 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_21, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_22 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_11, 0, 2, 1, 3), kwargs = {})
    %getitem_80 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_22, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_23 : [num_users=1] = call_method[target=permute](args = (%getitem_75, 0, 2, 1, 3), kwargs = {})
    %getitem_81 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_23, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_39 : [num_users=1] = call_method[target=size](args = (%getitem_79, -2), kwargs = {})
    %size_40 : [num_users=1] = call_method[target=size](args = (%getitem_80, -2), kwargs = {})
    %size_41 : [num_users=1] = call_method[target=size](args = (%getitem_79, -1), kwargs = {})
    %sqrt_5 : [num_users=1] = call_function[target=math.sqrt](args = (%size_41,), kwargs = {})
    %truediv_10 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_5), kwargs = {})
    %getattr_41 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_79, dtype), kwargs = {})
    %getattr_42 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_79, device), kwargs = {})
    %zeros_5 : [num_users=2] = call_function[target=torch.zeros](args = (%size_39, %size_40), kwargs = {dtype: %getattr_41, device: %getattr_42})
    %logical_not_5 : [num_users=1] = call_method[target=logical_not](args = (%to_35,), kwargs = {})
    %masked_fill__5 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_5, %logical_not_5, -inf), kwargs = {})
    %transpose_5 : [num_users=1] = call_method[target=transpose](args = (%getitem_80, -2, -1), kwargs = {})
    %matmul_10 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_79, %transpose_5), kwargs = {})
    %tensor_5 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_10,), kwargs = {requires_grad: False})
    %mul_31 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_10, %tensor_5), kwargs = {})
    %detach_15 : [num_users=1] = call_method[target=detach](args = (%zeros_5,), kwargs = {})
    %add_20 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_31, %detach_15), kwargs = {})
    %softmax_5 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_20,), kwargs = {dim: -1})
    %matmul_11 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_5, %getitem_81), kwargs = {})
    %permute_24 : [num_users=1] = call_method[target=permute](args = (%matmul_11, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_5 : [num_users=1] = call_method[target=reshape](args = (%permute_24, %getitem_70, %getitem_71, 512), kwargs = {})
    %_0_transformer_encoder_5_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.5.self_attn.out_proj.weight]
    %_0_transformer_encoder_5_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.5.self_attn.out_proj.bias]
    %linear_epsilon_21 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_5, %_0_transformer_encoder_5_self_attn_out_proj_weight, %_0_transformer_encoder_5_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_5_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.5.deepnorm_alpha]
    %detach_16 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_5_deepnorm_alpha,), kwargs = {})
    %mul_32 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_16, %rms_norm_identity_custom_9), kwargs = {})
    %add_21 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_21, %mul_32), kwargs = {})
    %_0_transformer_encoder_5_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.5.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_10 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_10 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_21, %_0_transformer_encoder_5_norm1_scale, %_0_transformer_encoder_17_norm2_eps_10, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_5_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.5.ff.fc1.weight]
    %linear_epsilon_22 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_10, %_0_transformer_encoder_5_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_5 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_22, 2), kwargs = {dim: -1})
    %getitem_82 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_5, 0), kwargs = {})
    %getitem_83 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_5, 1), kwargs = {})
    %mul_33 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_83, %getitem_82), kwargs = {})
    %mul_34 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_33, 1), kwargs = {})
    %neg_5 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_83,), kwargs = {})
    %exp_5 : [num_users=1] = call_function[target=torch.exp](args = (%neg_5,), kwargs = {})
    %_tensor_constant17 : [num_users=1] = get_attr[target=_tensor_constant17]
    %add_22 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant17, %exp_5), kwargs = {})
    %truediv_11 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_34, %add_22), kwargs = {})
    %_0_transformer_encoder_5_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.5.ff.fc2.weight]
    %linear_epsilon_23 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_11, %_0_transformer_encoder_5_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_17 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_5_deepnorm_alpha,), kwargs = {})
    %mul_35 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_17, %rms_norm_identity_custom_10), kwargs = {})
    %add_23 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_23, %mul_35), kwargs = {})
    %_0_transformer_encoder_5_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.5.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_11 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_11 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_23, %_0_transformer_encoder_5_norm2_scale, %_0_transformer_encoder_17_norm2_eps_11, 512, -1.0, False), kwargs = {})
    %size_42 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_11,), kwargs = {})
    %getitem_84 : [num_users=2] = call_function[target=operator.getitem](args = (%size_42, 0), kwargs = {})
    %getitem_85 : [num_users=2] = call_function[target=operator.getitem](args = (%size_42, 1), kwargs = {})
    %getitem_86 : [num_users=0] = call_function[target=operator.getitem](args = (%size_42, 2), kwargs = {})
    %_0_transformer_encoder_6_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.6.self_attn.Wqkv.weight]
    %linear_epsilon_24 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_11, %_0_transformer_encoder_6_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_6 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_24, %getitem_84, %getitem_85, 3, 8, 64), kwargs = {})
    %getitem_87 : [num_users=3] = call_function[target=operator.getitem](args = (%view_6, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_88 : [num_users=3] = call_function[target=operator.getitem](args = (%view_6, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_89 : [num_users=1] = call_function[target=operator.getitem](args = (%view_6, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_43 : [num_users=1] = call_method[target=size](args = (%getitem_87,), kwargs = {})
    %getitem_90 : [num_users=1] = call_function[target=operator.getitem](args = (%size_43, 1), kwargs = {})
    %arange_12 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_90,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_6_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.6.self_attn.rotary_emb_flash.inv_freq]
    %getattr_43 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_6_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_12 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_43, torch.float32), kwargs = {})
    %_tensor_constant18 : [num_users=1] = get_attr[target=_tensor_constant18]
    %outer_12 : [num_users=2] = call_function[target=torch.outer](args = (%arange_12, %_tensor_constant18), kwargs = {})
    %cos_12 : [num_users=1] = call_function[target=torch.cos](args = (%outer_12,), kwargs = {})
    %getattr_44 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_87, dtype), kwargs = {})
    %to_36 : [num_users=1] = call_method[target=to](args = (%cos_12, %getattr_44), kwargs = {})
    %sin_12 : [num_users=1] = call_function[target=torch.sin](args = (%outer_12,), kwargs = {})
    %to_37 : [num_users=1] = call_method[target=to](args = (%sin_12, %getattr_44), kwargs = {})
    %apply_rotary_emb_torch_12 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_87, %to_36, %to_37, False), kwargs = {})
    %size_44 : [num_users=1] = call_method[target=size](args = (%getitem_88,), kwargs = {})
    %getitem_91 : [num_users=1] = call_function[target=operator.getitem](args = (%size_44, 1), kwargs = {})
    %arange_13 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_91,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_45 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_6_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_13 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_45, torch.float32), kwargs = {})
    %_tensor_constant19 : [num_users=1] = get_attr[target=_tensor_constant19]
    %outer_13 : [num_users=2] = call_function[target=torch.outer](args = (%arange_13, %_tensor_constant19), kwargs = {})
    %cos_13 : [num_users=1] = call_function[target=torch.cos](args = (%outer_13,), kwargs = {})
    %getattr_46 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_88, dtype), kwargs = {})
    %to_38 : [num_users=1] = call_method[target=to](args = (%cos_13, %getattr_46), kwargs = {})
    %sin_13 : [num_users=1] = call_function[target=torch.sin](args = (%outer_13,), kwargs = {})
    %to_39 : [num_users=1] = call_method[target=to](args = (%sin_13, %getattr_46), kwargs = {})
    %apply_rotary_emb_torch_13 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_88, %to_38, %to_39, False), kwargs = {})
    %size_45 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_12,), kwargs = {})
    %getitem_92 : [num_users=1] = call_function[target=operator.getitem](args = (%size_45, 1), kwargs = {})
    %full_6 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_92, %getitem_92),), kwargs = {fill_value: 1.0})
    %triu_6 : [num_users=2] = call_function[target=torch.triu](args = (%full_6,), kwargs = {diagonal: -127})
    %tril_6 : [num_users=1] = call_function[target=torch.tril](args = (%triu_6,), kwargs = {diagonal: 128})
    %mul_36 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_6, %tril_6), kwargs = {})
    %to_40 : [num_users=1] = call_method[target=to](args = (%mul_36, torch.bool), kwargs = {})
    %getattr_47 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_12, device), kwargs = {})
    %to_41 : [num_users=1] = call_method[target=to](args = (%to_40, %getattr_47), kwargs = {})
    %permute_25 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_12, 0, 2, 1, 3), kwargs = {})
    %getitem_93 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_25, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_26 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_13, 0, 2, 1, 3), kwargs = {})
    %getitem_94 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_26, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_27 : [num_users=1] = call_method[target=permute](args = (%getitem_89, 0, 2, 1, 3), kwargs = {})
    %getitem_95 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_27, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_46 : [num_users=1] = call_method[target=size](args = (%getitem_93, -2), kwargs = {})
    %size_47 : [num_users=1] = call_method[target=size](args = (%getitem_94, -2), kwargs = {})
    %size_48 : [num_users=1] = call_method[target=size](args = (%getitem_93, -1), kwargs = {})
    %sqrt_6 : [num_users=1] = call_function[target=math.sqrt](args = (%size_48,), kwargs = {})
    %truediv_12 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_6), kwargs = {})
    %getattr_48 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_93, dtype), kwargs = {})
    %getattr_49 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_93, device), kwargs = {})
    %zeros_6 : [num_users=2] = call_function[target=torch.zeros](args = (%size_46, %size_47), kwargs = {dtype: %getattr_48, device: %getattr_49})
    %logical_not_6 : [num_users=1] = call_method[target=logical_not](args = (%to_41,), kwargs = {})
    %masked_fill__6 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_6, %logical_not_6, -inf), kwargs = {})
    %transpose_6 : [num_users=1] = call_method[target=transpose](args = (%getitem_94, -2, -1), kwargs = {})
    %matmul_12 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_93, %transpose_6), kwargs = {})
    %tensor_6 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_12,), kwargs = {requires_grad: False})
    %mul_37 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_12, %tensor_6), kwargs = {})
    %detach_18 : [num_users=1] = call_method[target=detach](args = (%zeros_6,), kwargs = {})
    %add_24 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_37, %detach_18), kwargs = {})
    %softmax_6 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_24,), kwargs = {dim: -1})
    %matmul_13 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_6, %getitem_95), kwargs = {})
    %permute_28 : [num_users=1] = call_method[target=permute](args = (%matmul_13, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_6 : [num_users=1] = call_method[target=reshape](args = (%permute_28, %getitem_84, %getitem_85, 512), kwargs = {})
    %_0_transformer_encoder_6_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.6.self_attn.out_proj.weight]
    %_0_transformer_encoder_6_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.6.self_attn.out_proj.bias]
    %linear_epsilon_25 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_6, %_0_transformer_encoder_6_self_attn_out_proj_weight, %_0_transformer_encoder_6_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_6_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.6.deepnorm_alpha]
    %detach_19 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_6_deepnorm_alpha,), kwargs = {})
    %mul_38 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_19, %rms_norm_identity_custom_11), kwargs = {})
    %add_25 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_25, %mul_38), kwargs = {})
    %_0_transformer_encoder_6_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.6.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_12 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_12 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_25, %_0_transformer_encoder_6_norm1_scale, %_0_transformer_encoder_17_norm2_eps_12, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_6_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.6.ff.fc1.weight]
    %linear_epsilon_26 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_12, %_0_transformer_encoder_6_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_6 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_26, 2), kwargs = {dim: -1})
    %getitem_96 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_6, 0), kwargs = {})
    %getitem_97 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_6, 1), kwargs = {})
    %mul_39 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_97, %getitem_96), kwargs = {})
    %mul_40 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_39, 1), kwargs = {})
    %neg_6 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_97,), kwargs = {})
    %exp_6 : [num_users=1] = call_function[target=torch.exp](args = (%neg_6,), kwargs = {})
    %_tensor_constant20 : [num_users=1] = get_attr[target=_tensor_constant20]
    %add_26 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant20, %exp_6), kwargs = {})
    %truediv_13 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_40, %add_26), kwargs = {})
    %_0_transformer_encoder_6_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.6.ff.fc2.weight]
    %linear_epsilon_27 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_13, %_0_transformer_encoder_6_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_20 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_6_deepnorm_alpha,), kwargs = {})
    %mul_41 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_20, %rms_norm_identity_custom_12), kwargs = {})
    %add_27 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_27, %mul_41), kwargs = {})
    %_0_transformer_encoder_6_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.6.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_13 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_13 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_27, %_0_transformer_encoder_6_norm2_scale, %_0_transformer_encoder_17_norm2_eps_13, 512, -1.0, False), kwargs = {})
    %size_49 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_13,), kwargs = {})
    %getitem_98 : [num_users=2] = call_function[target=operator.getitem](args = (%size_49, 0), kwargs = {})
    %getitem_99 : [num_users=2] = call_function[target=operator.getitem](args = (%size_49, 1), kwargs = {})
    %getitem_100 : [num_users=0] = call_function[target=operator.getitem](args = (%size_49, 2), kwargs = {})
    %_0_transformer_encoder_7_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.7.self_attn.Wqkv.weight]
    %linear_epsilon_28 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_13, %_0_transformer_encoder_7_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_7 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_28, %getitem_98, %getitem_99, 3, 8, 64), kwargs = {})
    %getitem_101 : [num_users=3] = call_function[target=operator.getitem](args = (%view_7, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_102 : [num_users=3] = call_function[target=operator.getitem](args = (%view_7, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_103 : [num_users=1] = call_function[target=operator.getitem](args = (%view_7, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_50 : [num_users=1] = call_method[target=size](args = (%getitem_101,), kwargs = {})
    %getitem_104 : [num_users=1] = call_function[target=operator.getitem](args = (%size_50, 1), kwargs = {})
    %arange_14 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_104,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_7_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.7.self_attn.rotary_emb_flash.inv_freq]
    %getattr_50 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_7_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_14 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_50, torch.float32), kwargs = {})
    %_tensor_constant21 : [num_users=1] = get_attr[target=_tensor_constant21]
    %outer_14 : [num_users=2] = call_function[target=torch.outer](args = (%arange_14, %_tensor_constant21), kwargs = {})
    %cos_14 : [num_users=1] = call_function[target=torch.cos](args = (%outer_14,), kwargs = {})
    %getattr_51 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_101, dtype), kwargs = {})
    %to_42 : [num_users=1] = call_method[target=to](args = (%cos_14, %getattr_51), kwargs = {})
    %sin_14 : [num_users=1] = call_function[target=torch.sin](args = (%outer_14,), kwargs = {})
    %to_43 : [num_users=1] = call_method[target=to](args = (%sin_14, %getattr_51), kwargs = {})
    %apply_rotary_emb_torch_14 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_101, %to_42, %to_43, False), kwargs = {})
    %size_51 : [num_users=1] = call_method[target=size](args = (%getitem_102,), kwargs = {})
    %getitem_105 : [num_users=1] = call_function[target=operator.getitem](args = (%size_51, 1), kwargs = {})
    %arange_15 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_105,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_52 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_7_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_15 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_52, torch.float32), kwargs = {})
    %_tensor_constant22 : [num_users=1] = get_attr[target=_tensor_constant22]
    %outer_15 : [num_users=2] = call_function[target=torch.outer](args = (%arange_15, %_tensor_constant22), kwargs = {})
    %cos_15 : [num_users=1] = call_function[target=torch.cos](args = (%outer_15,), kwargs = {})
    %getattr_53 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_102, dtype), kwargs = {})
    %to_44 : [num_users=1] = call_method[target=to](args = (%cos_15, %getattr_53), kwargs = {})
    %sin_15 : [num_users=1] = call_function[target=torch.sin](args = (%outer_15,), kwargs = {})
    %to_45 : [num_users=1] = call_method[target=to](args = (%sin_15, %getattr_53), kwargs = {})
    %apply_rotary_emb_torch_15 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_102, %to_44, %to_45, False), kwargs = {})
    %size_52 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_14,), kwargs = {})
    %getitem_106 : [num_users=1] = call_function[target=operator.getitem](args = (%size_52, 1), kwargs = {})
    %full_7 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_106, %getitem_106),), kwargs = {fill_value: 1.0})
    %triu_7 : [num_users=2] = call_function[target=torch.triu](args = (%full_7,), kwargs = {diagonal: -127})
    %tril_7 : [num_users=1] = call_function[target=torch.tril](args = (%triu_7,), kwargs = {diagonal: 128})
    %mul_42 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_7, %tril_7), kwargs = {})
    %to_46 : [num_users=1] = call_method[target=to](args = (%mul_42, torch.bool), kwargs = {})
    %getattr_54 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_14, device), kwargs = {})
    %to_47 : [num_users=1] = call_method[target=to](args = (%to_46, %getattr_54), kwargs = {})
    %permute_29 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_14, 0, 2, 1, 3), kwargs = {})
    %getitem_107 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_29, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_30 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_15, 0, 2, 1, 3), kwargs = {})
    %getitem_108 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_30, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_31 : [num_users=1] = call_method[target=permute](args = (%getitem_103, 0, 2, 1, 3), kwargs = {})
    %getitem_109 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_31, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_53 : [num_users=1] = call_method[target=size](args = (%getitem_107, -2), kwargs = {})
    %size_54 : [num_users=1] = call_method[target=size](args = (%getitem_108, -2), kwargs = {})
    %size_55 : [num_users=1] = call_method[target=size](args = (%getitem_107, -1), kwargs = {})
    %sqrt_7 : [num_users=1] = call_function[target=math.sqrt](args = (%size_55,), kwargs = {})
    %truediv_14 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_7), kwargs = {})
    %getattr_55 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_107, dtype), kwargs = {})
    %getattr_56 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_107, device), kwargs = {})
    %zeros_7 : [num_users=2] = call_function[target=torch.zeros](args = (%size_53, %size_54), kwargs = {dtype: %getattr_55, device: %getattr_56})
    %logical_not_7 : [num_users=1] = call_method[target=logical_not](args = (%to_47,), kwargs = {})
    %masked_fill__7 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_7, %logical_not_7, -inf), kwargs = {})
    %transpose_7 : [num_users=1] = call_method[target=transpose](args = (%getitem_108, -2, -1), kwargs = {})
    %matmul_14 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_107, %transpose_7), kwargs = {})
    %tensor_7 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_14,), kwargs = {requires_grad: False})
    %mul_43 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_14, %tensor_7), kwargs = {})
    %detach_21 : [num_users=1] = call_method[target=detach](args = (%zeros_7,), kwargs = {})
    %add_28 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_43, %detach_21), kwargs = {})
    %softmax_7 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_28,), kwargs = {dim: -1})
    %matmul_15 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_7, %getitem_109), kwargs = {})
    %permute_32 : [num_users=1] = call_method[target=permute](args = (%matmul_15, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_7 : [num_users=1] = call_method[target=reshape](args = (%permute_32, %getitem_98, %getitem_99, 512), kwargs = {})
    %_0_transformer_encoder_7_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.7.self_attn.out_proj.weight]
    %_0_transformer_encoder_7_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.7.self_attn.out_proj.bias]
    %linear_epsilon_29 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_7, %_0_transformer_encoder_7_self_attn_out_proj_weight, %_0_transformer_encoder_7_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_7_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.7.deepnorm_alpha]
    %detach_22 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_7_deepnorm_alpha,), kwargs = {})
    %mul_44 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_22, %rms_norm_identity_custom_13), kwargs = {})
    %add_29 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_29, %mul_44), kwargs = {})
    %_0_transformer_encoder_7_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.7.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_14 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_14 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_29, %_0_transformer_encoder_7_norm1_scale, %_0_transformer_encoder_17_norm2_eps_14, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_7_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.7.ff.fc1.weight]
    %linear_epsilon_30 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_14, %_0_transformer_encoder_7_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_7 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_30, 2), kwargs = {dim: -1})
    %getitem_110 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_7, 0), kwargs = {})
    %getitem_111 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_7, 1), kwargs = {})
    %mul_45 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_111, %getitem_110), kwargs = {})
    %mul_46 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_45, 1), kwargs = {})
    %neg_7 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_111,), kwargs = {})
    %exp_7 : [num_users=1] = call_function[target=torch.exp](args = (%neg_7,), kwargs = {})
    %_tensor_constant23 : [num_users=1] = get_attr[target=_tensor_constant23]
    %add_30 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant23, %exp_7), kwargs = {})
    %truediv_15 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_46, %add_30), kwargs = {})
    %_0_transformer_encoder_7_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.7.ff.fc2.weight]
    %linear_epsilon_31 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_15, %_0_transformer_encoder_7_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_23 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_7_deepnorm_alpha,), kwargs = {})
    %mul_47 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_23, %rms_norm_identity_custom_14), kwargs = {})
    %add_31 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_31, %mul_47), kwargs = {})
    %_0_transformer_encoder_7_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.7.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_15 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_15 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_31, %_0_transformer_encoder_7_norm2_scale, %_0_transformer_encoder_17_norm2_eps_15, 512, -1.0, False), kwargs = {})
    %size_56 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_15,), kwargs = {})
    %getitem_112 : [num_users=2] = call_function[target=operator.getitem](args = (%size_56, 0), kwargs = {})
    %getitem_113 : [num_users=2] = call_function[target=operator.getitem](args = (%size_56, 1), kwargs = {})
    %getitem_114 : [num_users=0] = call_function[target=operator.getitem](args = (%size_56, 2), kwargs = {})
    %_0_transformer_encoder_8_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.8.self_attn.Wqkv.weight]
    %linear_epsilon_32 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_15, %_0_transformer_encoder_8_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_8 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_32, %getitem_112, %getitem_113, 3, 8, 64), kwargs = {})
    %getitem_115 : [num_users=3] = call_function[target=operator.getitem](args = (%view_8, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_116 : [num_users=3] = call_function[target=operator.getitem](args = (%view_8, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_117 : [num_users=1] = call_function[target=operator.getitem](args = (%view_8, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_57 : [num_users=1] = call_method[target=size](args = (%getitem_115,), kwargs = {})
    %getitem_118 : [num_users=1] = call_function[target=operator.getitem](args = (%size_57, 1), kwargs = {})
    %arange_16 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_118,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_8_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.8.self_attn.rotary_emb_flash.inv_freq]
    %getattr_57 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_8_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_16 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_57, torch.float32), kwargs = {})
    %_tensor_constant24 : [num_users=1] = get_attr[target=_tensor_constant24]
    %outer_16 : [num_users=2] = call_function[target=torch.outer](args = (%arange_16, %_tensor_constant24), kwargs = {})
    %cos_16 : [num_users=1] = call_function[target=torch.cos](args = (%outer_16,), kwargs = {})
    %getattr_58 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_115, dtype), kwargs = {})
    %to_48 : [num_users=1] = call_method[target=to](args = (%cos_16, %getattr_58), kwargs = {})
    %sin_16 : [num_users=1] = call_function[target=torch.sin](args = (%outer_16,), kwargs = {})
    %to_49 : [num_users=1] = call_method[target=to](args = (%sin_16, %getattr_58), kwargs = {})
    %apply_rotary_emb_torch_16 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_115, %to_48, %to_49, False), kwargs = {})
    %size_58 : [num_users=1] = call_method[target=size](args = (%getitem_116,), kwargs = {})
    %getitem_119 : [num_users=1] = call_function[target=operator.getitem](args = (%size_58, 1), kwargs = {})
    %arange_17 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_119,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_59 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_8_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_17 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_59, torch.float32), kwargs = {})
    %_tensor_constant25 : [num_users=1] = get_attr[target=_tensor_constant25]
    %outer_17 : [num_users=2] = call_function[target=torch.outer](args = (%arange_17, %_tensor_constant25), kwargs = {})
    %cos_17 : [num_users=1] = call_function[target=torch.cos](args = (%outer_17,), kwargs = {})
    %getattr_60 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_116, dtype), kwargs = {})
    %to_50 : [num_users=1] = call_method[target=to](args = (%cos_17, %getattr_60), kwargs = {})
    %sin_17 : [num_users=1] = call_function[target=torch.sin](args = (%outer_17,), kwargs = {})
    %to_51 : [num_users=1] = call_method[target=to](args = (%sin_17, %getattr_60), kwargs = {})
    %apply_rotary_emb_torch_17 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_116, %to_50, %to_51, False), kwargs = {})
    %size_59 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_16,), kwargs = {})
    %getitem_120 : [num_users=1] = call_function[target=operator.getitem](args = (%size_59, 1), kwargs = {})
    %full_8 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_120, %getitem_120),), kwargs = {fill_value: 1.0})
    %triu_8 : [num_users=2] = call_function[target=torch.triu](args = (%full_8,), kwargs = {diagonal: -127})
    %tril_8 : [num_users=1] = call_function[target=torch.tril](args = (%triu_8,), kwargs = {diagonal: 128})
    %mul_48 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_8, %tril_8), kwargs = {})
    %to_52 : [num_users=1] = call_method[target=to](args = (%mul_48, torch.bool), kwargs = {})
    %getattr_61 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_16, device), kwargs = {})
    %to_53 : [num_users=1] = call_method[target=to](args = (%to_52, %getattr_61), kwargs = {})
    %permute_33 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_16, 0, 2, 1, 3), kwargs = {})
    %getitem_121 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_33, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_34 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_17, 0, 2, 1, 3), kwargs = {})
    %getitem_122 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_34, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_35 : [num_users=1] = call_method[target=permute](args = (%getitem_117, 0, 2, 1, 3), kwargs = {})
    %getitem_123 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_35, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_60 : [num_users=1] = call_method[target=size](args = (%getitem_121, -2), kwargs = {})
    %size_61 : [num_users=1] = call_method[target=size](args = (%getitem_122, -2), kwargs = {})
    %size_62 : [num_users=1] = call_method[target=size](args = (%getitem_121, -1), kwargs = {})
    %sqrt_8 : [num_users=1] = call_function[target=math.sqrt](args = (%size_62,), kwargs = {})
    %truediv_16 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_8), kwargs = {})
    %getattr_62 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_121, dtype), kwargs = {})
    %getattr_63 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_121, device), kwargs = {})
    %zeros_8 : [num_users=2] = call_function[target=torch.zeros](args = (%size_60, %size_61), kwargs = {dtype: %getattr_62, device: %getattr_63})
    %logical_not_8 : [num_users=1] = call_method[target=logical_not](args = (%to_53,), kwargs = {})
    %masked_fill__8 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_8, %logical_not_8, -inf), kwargs = {})
    %transpose_8 : [num_users=1] = call_method[target=transpose](args = (%getitem_122, -2, -1), kwargs = {})
    %matmul_16 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_121, %transpose_8), kwargs = {})
    %tensor_8 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_16,), kwargs = {requires_grad: False})
    %mul_49 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_16, %tensor_8), kwargs = {})
    %detach_24 : [num_users=1] = call_method[target=detach](args = (%zeros_8,), kwargs = {})
    %add_32 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_49, %detach_24), kwargs = {})
    %softmax_8 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_32,), kwargs = {dim: -1})
    %matmul_17 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_8, %getitem_123), kwargs = {})
    %permute_36 : [num_users=1] = call_method[target=permute](args = (%matmul_17, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_8 : [num_users=1] = call_method[target=reshape](args = (%permute_36, %getitem_112, %getitem_113, 512), kwargs = {})
    %_0_transformer_encoder_8_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.8.self_attn.out_proj.weight]
    %_0_transformer_encoder_8_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.8.self_attn.out_proj.bias]
    %linear_epsilon_33 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_8, %_0_transformer_encoder_8_self_attn_out_proj_weight, %_0_transformer_encoder_8_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_8_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.8.deepnorm_alpha]
    %detach_25 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_8_deepnorm_alpha,), kwargs = {})
    %mul_50 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_25, %rms_norm_identity_custom_15), kwargs = {})
    %add_33 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_33, %mul_50), kwargs = {})
    %_0_transformer_encoder_8_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.8.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_16 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_16 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_33, %_0_transformer_encoder_8_norm1_scale, %_0_transformer_encoder_17_norm2_eps_16, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_8_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.8.ff.fc1.weight]
    %linear_epsilon_34 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_16, %_0_transformer_encoder_8_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_8 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_34, 2), kwargs = {dim: -1})
    %getitem_124 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_8, 0), kwargs = {})
    %getitem_125 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_8, 1), kwargs = {})
    %mul_51 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_125, %getitem_124), kwargs = {})
    %mul_52 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_51, 1), kwargs = {})
    %neg_8 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_125,), kwargs = {})
    %exp_8 : [num_users=1] = call_function[target=torch.exp](args = (%neg_8,), kwargs = {})
    %_tensor_constant26 : [num_users=1] = get_attr[target=_tensor_constant26]
    %add_34 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant26, %exp_8), kwargs = {})
    %truediv_17 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_52, %add_34), kwargs = {})
    %_0_transformer_encoder_8_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.8.ff.fc2.weight]
    %linear_epsilon_35 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_17, %_0_transformer_encoder_8_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_26 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_8_deepnorm_alpha,), kwargs = {})
    %mul_53 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_26, %rms_norm_identity_custom_16), kwargs = {})
    %add_35 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_35, %mul_53), kwargs = {})
    %_0_transformer_encoder_8_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.8.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_17 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_17 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_35, %_0_transformer_encoder_8_norm2_scale, %_0_transformer_encoder_17_norm2_eps_17, 512, -1.0, False), kwargs = {})
    %size_63 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_17,), kwargs = {})
    %getitem_126 : [num_users=2] = call_function[target=operator.getitem](args = (%size_63, 0), kwargs = {})
    %getitem_127 : [num_users=2] = call_function[target=operator.getitem](args = (%size_63, 1), kwargs = {})
    %getitem_128 : [num_users=0] = call_function[target=operator.getitem](args = (%size_63, 2), kwargs = {})
    %_0_transformer_encoder_9_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.9.self_attn.Wqkv.weight]
    %linear_epsilon_36 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_17, %_0_transformer_encoder_9_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_9 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_36, %getitem_126, %getitem_127, 3, 8, 64), kwargs = {})
    %getitem_129 : [num_users=3] = call_function[target=operator.getitem](args = (%view_9, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_130 : [num_users=3] = call_function[target=operator.getitem](args = (%view_9, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_131 : [num_users=1] = call_function[target=operator.getitem](args = (%view_9, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_64 : [num_users=1] = call_method[target=size](args = (%getitem_129,), kwargs = {})
    %getitem_132 : [num_users=1] = call_function[target=operator.getitem](args = (%size_64, 1), kwargs = {})
    %arange_18 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_132,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_9_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.9.self_attn.rotary_emb_flash.inv_freq]
    %getattr_64 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_9_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_18 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_64, torch.float32), kwargs = {})
    %_tensor_constant27 : [num_users=1] = get_attr[target=_tensor_constant27]
    %outer_18 : [num_users=2] = call_function[target=torch.outer](args = (%arange_18, %_tensor_constant27), kwargs = {})
    %cos_18 : [num_users=1] = call_function[target=torch.cos](args = (%outer_18,), kwargs = {})
    %getattr_65 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_129, dtype), kwargs = {})
    %to_54 : [num_users=1] = call_method[target=to](args = (%cos_18, %getattr_65), kwargs = {})
    %sin_18 : [num_users=1] = call_function[target=torch.sin](args = (%outer_18,), kwargs = {})
    %to_55 : [num_users=1] = call_method[target=to](args = (%sin_18, %getattr_65), kwargs = {})
    %apply_rotary_emb_torch_18 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_129, %to_54, %to_55, False), kwargs = {})
    %size_65 : [num_users=1] = call_method[target=size](args = (%getitem_130,), kwargs = {})
    %getitem_133 : [num_users=1] = call_function[target=operator.getitem](args = (%size_65, 1), kwargs = {})
    %arange_19 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_133,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_66 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_9_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_19 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_66, torch.float32), kwargs = {})
    %_tensor_constant28 : [num_users=1] = get_attr[target=_tensor_constant28]
    %outer_19 : [num_users=2] = call_function[target=torch.outer](args = (%arange_19, %_tensor_constant28), kwargs = {})
    %cos_19 : [num_users=1] = call_function[target=torch.cos](args = (%outer_19,), kwargs = {})
    %getattr_67 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_130, dtype), kwargs = {})
    %to_56 : [num_users=1] = call_method[target=to](args = (%cos_19, %getattr_67), kwargs = {})
    %sin_19 : [num_users=1] = call_function[target=torch.sin](args = (%outer_19,), kwargs = {})
    %to_57 : [num_users=1] = call_method[target=to](args = (%sin_19, %getattr_67), kwargs = {})
    %apply_rotary_emb_torch_19 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_130, %to_56, %to_57, False), kwargs = {})
    %size_66 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_18,), kwargs = {})
    %getitem_134 : [num_users=1] = call_function[target=operator.getitem](args = (%size_66, 1), kwargs = {})
    %full_9 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_134, %getitem_134),), kwargs = {fill_value: 1.0})
    %triu_9 : [num_users=2] = call_function[target=torch.triu](args = (%full_9,), kwargs = {diagonal: -127})
    %tril_9 : [num_users=1] = call_function[target=torch.tril](args = (%triu_9,), kwargs = {diagonal: 128})
    %mul_54 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_9, %tril_9), kwargs = {})
    %to_58 : [num_users=1] = call_method[target=to](args = (%mul_54, torch.bool), kwargs = {})
    %getattr_68 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_18, device), kwargs = {})
    %to_59 : [num_users=1] = call_method[target=to](args = (%to_58, %getattr_68), kwargs = {})
    %permute_37 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_18, 0, 2, 1, 3), kwargs = {})
    %getitem_135 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_37, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_38 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_19, 0, 2, 1, 3), kwargs = {})
    %getitem_136 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_38, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_39 : [num_users=1] = call_method[target=permute](args = (%getitem_131, 0, 2, 1, 3), kwargs = {})
    %getitem_137 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_39, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_67 : [num_users=1] = call_method[target=size](args = (%getitem_135, -2), kwargs = {})
    %size_68 : [num_users=1] = call_method[target=size](args = (%getitem_136, -2), kwargs = {})
    %size_69 : [num_users=1] = call_method[target=size](args = (%getitem_135, -1), kwargs = {})
    %sqrt_9 : [num_users=1] = call_function[target=math.sqrt](args = (%size_69,), kwargs = {})
    %truediv_18 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_9), kwargs = {})
    %getattr_69 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_135, dtype), kwargs = {})
    %getattr_70 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_135, device), kwargs = {})
    %zeros_9 : [num_users=2] = call_function[target=torch.zeros](args = (%size_67, %size_68), kwargs = {dtype: %getattr_69, device: %getattr_70})
    %logical_not_9 : [num_users=1] = call_method[target=logical_not](args = (%to_59,), kwargs = {})
    %masked_fill__9 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_9, %logical_not_9, -inf), kwargs = {})
    %transpose_9 : [num_users=1] = call_method[target=transpose](args = (%getitem_136, -2, -1), kwargs = {})
    %matmul_18 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_135, %transpose_9), kwargs = {})
    %tensor_9 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_18,), kwargs = {requires_grad: False})
    %mul_55 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_18, %tensor_9), kwargs = {})
    %detach_27 : [num_users=1] = call_method[target=detach](args = (%zeros_9,), kwargs = {})
    %add_36 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_55, %detach_27), kwargs = {})
    %softmax_9 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_36,), kwargs = {dim: -1})
    %matmul_19 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_9, %getitem_137), kwargs = {})
    %permute_40 : [num_users=1] = call_method[target=permute](args = (%matmul_19, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_9 : [num_users=1] = call_method[target=reshape](args = (%permute_40, %getitem_126, %getitem_127, 512), kwargs = {})
    %_0_transformer_encoder_9_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.9.self_attn.out_proj.weight]
    %_0_transformer_encoder_9_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.9.self_attn.out_proj.bias]
    %linear_epsilon_37 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_9, %_0_transformer_encoder_9_self_attn_out_proj_weight, %_0_transformer_encoder_9_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_9_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.9.deepnorm_alpha]
    %detach_28 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_9_deepnorm_alpha,), kwargs = {})
    %mul_56 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_28, %rms_norm_identity_custom_17), kwargs = {})
    %add_37 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_37, %mul_56), kwargs = {})
    %_0_transformer_encoder_9_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.9.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_18 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_18 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_37, %_0_transformer_encoder_9_norm1_scale, %_0_transformer_encoder_17_norm2_eps_18, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_9_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.9.ff.fc1.weight]
    %linear_epsilon_38 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_18, %_0_transformer_encoder_9_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_9 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_38, 2), kwargs = {dim: -1})
    %getitem_138 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_9, 0), kwargs = {})
    %getitem_139 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_9, 1), kwargs = {})
    %mul_57 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_139, %getitem_138), kwargs = {})
    %mul_58 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_57, 1), kwargs = {})
    %neg_9 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_139,), kwargs = {})
    %exp_9 : [num_users=1] = call_function[target=torch.exp](args = (%neg_9,), kwargs = {})
    %_tensor_constant29 : [num_users=1] = get_attr[target=_tensor_constant29]
    %add_38 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant29, %exp_9), kwargs = {})
    %truediv_19 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_58, %add_38), kwargs = {})
    %_0_transformer_encoder_9_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.9.ff.fc2.weight]
    %linear_epsilon_39 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_19, %_0_transformer_encoder_9_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_29 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_9_deepnorm_alpha,), kwargs = {})
    %mul_59 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_29, %rms_norm_identity_custom_18), kwargs = {})
    %add_39 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_39, %mul_59), kwargs = {})
    %_0_transformer_encoder_9_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.9.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_19 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_19 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_39, %_0_transformer_encoder_9_norm2_scale, %_0_transformer_encoder_17_norm2_eps_19, 512, -1.0, False), kwargs = {})
    %size_70 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_19,), kwargs = {})
    %getitem_140 : [num_users=2] = call_function[target=operator.getitem](args = (%size_70, 0), kwargs = {})
    %getitem_141 : [num_users=2] = call_function[target=operator.getitem](args = (%size_70, 1), kwargs = {})
    %getitem_142 : [num_users=0] = call_function[target=operator.getitem](args = (%size_70, 2), kwargs = {})
    %_0_transformer_encoder_10_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.10.self_attn.Wqkv.weight]
    %linear_epsilon_40 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_19, %_0_transformer_encoder_10_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_10 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_40, %getitem_140, %getitem_141, 3, 8, 64), kwargs = {})
    %getitem_143 : [num_users=3] = call_function[target=operator.getitem](args = (%view_10, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_144 : [num_users=3] = call_function[target=operator.getitem](args = (%view_10, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_145 : [num_users=1] = call_function[target=operator.getitem](args = (%view_10, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_71 : [num_users=1] = call_method[target=size](args = (%getitem_143,), kwargs = {})
    %getitem_146 : [num_users=1] = call_function[target=operator.getitem](args = (%size_71, 1), kwargs = {})
    %arange_20 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_146,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_10_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.10.self_attn.rotary_emb_flash.inv_freq]
    %getattr_71 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_10_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_20 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_71, torch.float32), kwargs = {})
    %_tensor_constant30 : [num_users=1] = get_attr[target=_tensor_constant30]
    %outer_20 : [num_users=2] = call_function[target=torch.outer](args = (%arange_20, %_tensor_constant30), kwargs = {})
    %cos_20 : [num_users=1] = call_function[target=torch.cos](args = (%outer_20,), kwargs = {})
    %getattr_72 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_143, dtype), kwargs = {})
    %to_60 : [num_users=1] = call_method[target=to](args = (%cos_20, %getattr_72), kwargs = {})
    %sin_20 : [num_users=1] = call_function[target=torch.sin](args = (%outer_20,), kwargs = {})
    %to_61 : [num_users=1] = call_method[target=to](args = (%sin_20, %getattr_72), kwargs = {})
    %apply_rotary_emb_torch_20 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_143, %to_60, %to_61, False), kwargs = {})
    %size_72 : [num_users=1] = call_method[target=size](args = (%getitem_144,), kwargs = {})
    %getitem_147 : [num_users=1] = call_function[target=operator.getitem](args = (%size_72, 1), kwargs = {})
    %arange_21 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_147,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_73 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_10_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_21 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_73, torch.float32), kwargs = {})
    %_tensor_constant31 : [num_users=1] = get_attr[target=_tensor_constant31]
    %outer_21 : [num_users=2] = call_function[target=torch.outer](args = (%arange_21, %_tensor_constant31), kwargs = {})
    %cos_21 : [num_users=1] = call_function[target=torch.cos](args = (%outer_21,), kwargs = {})
    %getattr_74 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_144, dtype), kwargs = {})
    %to_62 : [num_users=1] = call_method[target=to](args = (%cos_21, %getattr_74), kwargs = {})
    %sin_21 : [num_users=1] = call_function[target=torch.sin](args = (%outer_21,), kwargs = {})
    %to_63 : [num_users=1] = call_method[target=to](args = (%sin_21, %getattr_74), kwargs = {})
    %apply_rotary_emb_torch_21 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_144, %to_62, %to_63, False), kwargs = {})
    %size_73 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_20,), kwargs = {})
    %getitem_148 : [num_users=1] = call_function[target=operator.getitem](args = (%size_73, 1), kwargs = {})
    %full_10 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_148, %getitem_148),), kwargs = {fill_value: 1.0})
    %triu_10 : [num_users=2] = call_function[target=torch.triu](args = (%full_10,), kwargs = {diagonal: -127})
    %tril_10 : [num_users=1] = call_function[target=torch.tril](args = (%triu_10,), kwargs = {diagonal: 128})
    %mul_60 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_10, %tril_10), kwargs = {})
    %to_64 : [num_users=1] = call_method[target=to](args = (%mul_60, torch.bool), kwargs = {})
    %getattr_75 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_20, device), kwargs = {})
    %to_65 : [num_users=1] = call_method[target=to](args = (%to_64, %getattr_75), kwargs = {})
    %permute_41 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_20, 0, 2, 1, 3), kwargs = {})
    %getitem_149 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_41, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_42 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_21, 0, 2, 1, 3), kwargs = {})
    %getitem_150 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_42, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_43 : [num_users=1] = call_method[target=permute](args = (%getitem_145, 0, 2, 1, 3), kwargs = {})
    %getitem_151 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_43, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_74 : [num_users=1] = call_method[target=size](args = (%getitem_149, -2), kwargs = {})
    %size_75 : [num_users=1] = call_method[target=size](args = (%getitem_150, -2), kwargs = {})
    %size_76 : [num_users=1] = call_method[target=size](args = (%getitem_149, -1), kwargs = {})
    %sqrt_10 : [num_users=1] = call_function[target=math.sqrt](args = (%size_76,), kwargs = {})
    %truediv_20 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_10), kwargs = {})
    %getattr_76 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_149, dtype), kwargs = {})
    %getattr_77 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_149, device), kwargs = {})
    %zeros_10 : [num_users=2] = call_function[target=torch.zeros](args = (%size_74, %size_75), kwargs = {dtype: %getattr_76, device: %getattr_77})
    %logical_not_10 : [num_users=1] = call_method[target=logical_not](args = (%to_65,), kwargs = {})
    %masked_fill__10 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_10, %logical_not_10, -inf), kwargs = {})
    %transpose_10 : [num_users=1] = call_method[target=transpose](args = (%getitem_150, -2, -1), kwargs = {})
    %matmul_20 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_149, %transpose_10), kwargs = {})
    %tensor_10 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_20,), kwargs = {requires_grad: False})
    %mul_61 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_20, %tensor_10), kwargs = {})
    %detach_30 : [num_users=1] = call_method[target=detach](args = (%zeros_10,), kwargs = {})
    %add_40 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_61, %detach_30), kwargs = {})
    %softmax_10 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_40,), kwargs = {dim: -1})
    %matmul_21 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_10, %getitem_151), kwargs = {})
    %permute_44 : [num_users=1] = call_method[target=permute](args = (%matmul_21, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_10 : [num_users=1] = call_method[target=reshape](args = (%permute_44, %getitem_140, %getitem_141, 512), kwargs = {})
    %_0_transformer_encoder_10_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.10.self_attn.out_proj.weight]
    %_0_transformer_encoder_10_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.10.self_attn.out_proj.bias]
    %linear_epsilon_41 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_10, %_0_transformer_encoder_10_self_attn_out_proj_weight, %_0_transformer_encoder_10_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_10_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.10.deepnorm_alpha]
    %detach_31 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_10_deepnorm_alpha,), kwargs = {})
    %mul_62 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_31, %rms_norm_identity_custom_19), kwargs = {})
    %add_41 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_41, %mul_62), kwargs = {})
    %_0_transformer_encoder_10_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.10.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_20 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_20 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_41, %_0_transformer_encoder_10_norm1_scale, %_0_transformer_encoder_17_norm2_eps_20, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_10_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.10.ff.fc1.weight]
    %linear_epsilon_42 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_20, %_0_transformer_encoder_10_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_10 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_42, 2), kwargs = {dim: -1})
    %getitem_152 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_10, 0), kwargs = {})
    %getitem_153 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_10, 1), kwargs = {})
    %mul_63 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_153, %getitem_152), kwargs = {})
    %mul_64 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_63, 1), kwargs = {})
    %neg_10 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_153,), kwargs = {})
    %exp_10 : [num_users=1] = call_function[target=torch.exp](args = (%neg_10,), kwargs = {})
    %_tensor_constant32 : [num_users=1] = get_attr[target=_tensor_constant32]
    %add_42 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant32, %exp_10), kwargs = {})
    %truediv_21 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_64, %add_42), kwargs = {})
    %_0_transformer_encoder_10_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.10.ff.fc2.weight]
    %linear_epsilon_43 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_21, %_0_transformer_encoder_10_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_32 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_10_deepnorm_alpha,), kwargs = {})
    %mul_65 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_32, %rms_norm_identity_custom_20), kwargs = {})
    %add_43 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_43, %mul_65), kwargs = {})
    %_0_transformer_encoder_10_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.10.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_21 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_21 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_43, %_0_transformer_encoder_10_norm2_scale, %_0_transformer_encoder_17_norm2_eps_21, 512, -1.0, False), kwargs = {})
    %size_77 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_21,), kwargs = {})
    %getitem_154 : [num_users=2] = call_function[target=operator.getitem](args = (%size_77, 0), kwargs = {})
    %getitem_155 : [num_users=2] = call_function[target=operator.getitem](args = (%size_77, 1), kwargs = {})
    %getitem_156 : [num_users=0] = call_function[target=operator.getitem](args = (%size_77, 2), kwargs = {})
    %_0_transformer_encoder_11_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.11.self_attn.Wqkv.weight]
    %linear_epsilon_44 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_21, %_0_transformer_encoder_11_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_11 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_44, %getitem_154, %getitem_155, 3, 8, 64), kwargs = {})
    %getitem_157 : [num_users=3] = call_function[target=operator.getitem](args = (%view_11, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_158 : [num_users=3] = call_function[target=operator.getitem](args = (%view_11, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_159 : [num_users=1] = call_function[target=operator.getitem](args = (%view_11, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_78 : [num_users=1] = call_method[target=size](args = (%getitem_157,), kwargs = {})
    %getitem_160 : [num_users=1] = call_function[target=operator.getitem](args = (%size_78, 1), kwargs = {})
    %arange_22 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_160,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_11_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.11.self_attn.rotary_emb_flash.inv_freq]
    %getattr_78 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_11_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_22 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_78, torch.float32), kwargs = {})
    %_tensor_constant33 : [num_users=1] = get_attr[target=_tensor_constant33]
    %outer_22 : [num_users=2] = call_function[target=torch.outer](args = (%arange_22, %_tensor_constant33), kwargs = {})
    %cos_22 : [num_users=1] = call_function[target=torch.cos](args = (%outer_22,), kwargs = {})
    %getattr_79 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_157, dtype), kwargs = {})
    %to_66 : [num_users=1] = call_method[target=to](args = (%cos_22, %getattr_79), kwargs = {})
    %sin_22 : [num_users=1] = call_function[target=torch.sin](args = (%outer_22,), kwargs = {})
    %to_67 : [num_users=1] = call_method[target=to](args = (%sin_22, %getattr_79), kwargs = {})
    %apply_rotary_emb_torch_22 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_157, %to_66, %to_67, False), kwargs = {})
    %size_79 : [num_users=1] = call_method[target=size](args = (%getitem_158,), kwargs = {})
    %getitem_161 : [num_users=1] = call_function[target=operator.getitem](args = (%size_79, 1), kwargs = {})
    %arange_23 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_161,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_80 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_11_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_23 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_80, torch.float32), kwargs = {})
    %_tensor_constant34 : [num_users=1] = get_attr[target=_tensor_constant34]
    %outer_23 : [num_users=2] = call_function[target=torch.outer](args = (%arange_23, %_tensor_constant34), kwargs = {})
    %cos_23 : [num_users=1] = call_function[target=torch.cos](args = (%outer_23,), kwargs = {})
    %getattr_81 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_158, dtype), kwargs = {})
    %to_68 : [num_users=1] = call_method[target=to](args = (%cos_23, %getattr_81), kwargs = {})
    %sin_23 : [num_users=1] = call_function[target=torch.sin](args = (%outer_23,), kwargs = {})
    %to_69 : [num_users=1] = call_method[target=to](args = (%sin_23, %getattr_81), kwargs = {})
    %apply_rotary_emb_torch_23 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_158, %to_68, %to_69, False), kwargs = {})
    %size_80 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_22,), kwargs = {})
    %getitem_162 : [num_users=1] = call_function[target=operator.getitem](args = (%size_80, 1), kwargs = {})
    %full_11 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_162, %getitem_162),), kwargs = {fill_value: 1.0})
    %triu_11 : [num_users=2] = call_function[target=torch.triu](args = (%full_11,), kwargs = {diagonal: -127})
    %tril_11 : [num_users=1] = call_function[target=torch.tril](args = (%triu_11,), kwargs = {diagonal: 128})
    %mul_66 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_11, %tril_11), kwargs = {})
    %to_70 : [num_users=1] = call_method[target=to](args = (%mul_66, torch.bool), kwargs = {})
    %getattr_82 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_22, device), kwargs = {})
    %to_71 : [num_users=1] = call_method[target=to](args = (%to_70, %getattr_82), kwargs = {})
    %permute_45 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_22, 0, 2, 1, 3), kwargs = {})
    %getitem_163 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_45, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_46 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_23, 0, 2, 1, 3), kwargs = {})
    %getitem_164 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_46, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_47 : [num_users=1] = call_method[target=permute](args = (%getitem_159, 0, 2, 1, 3), kwargs = {})
    %getitem_165 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_47, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_81 : [num_users=1] = call_method[target=size](args = (%getitem_163, -2), kwargs = {})
    %size_82 : [num_users=1] = call_method[target=size](args = (%getitem_164, -2), kwargs = {})
    %size_83 : [num_users=1] = call_method[target=size](args = (%getitem_163, -1), kwargs = {})
    %sqrt_11 : [num_users=1] = call_function[target=math.sqrt](args = (%size_83,), kwargs = {})
    %truediv_22 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_11), kwargs = {})
    %getattr_83 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_163, dtype), kwargs = {})
    %getattr_84 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_163, device), kwargs = {})
    %zeros_11 : [num_users=2] = call_function[target=torch.zeros](args = (%size_81, %size_82), kwargs = {dtype: %getattr_83, device: %getattr_84})
    %logical_not_11 : [num_users=1] = call_method[target=logical_not](args = (%to_71,), kwargs = {})
    %masked_fill__11 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_11, %logical_not_11, -inf), kwargs = {})
    %transpose_11 : [num_users=1] = call_method[target=transpose](args = (%getitem_164, -2, -1), kwargs = {})
    %matmul_22 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_163, %transpose_11), kwargs = {})
    %tensor_11 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_22,), kwargs = {requires_grad: False})
    %mul_67 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_22, %tensor_11), kwargs = {})
    %detach_33 : [num_users=1] = call_method[target=detach](args = (%zeros_11,), kwargs = {})
    %add_44 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_67, %detach_33), kwargs = {})
    %softmax_11 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_44,), kwargs = {dim: -1})
    %matmul_23 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_11, %getitem_165), kwargs = {})
    %permute_48 : [num_users=1] = call_method[target=permute](args = (%matmul_23, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_11 : [num_users=1] = call_method[target=reshape](args = (%permute_48, %getitem_154, %getitem_155, 512), kwargs = {})
    %_0_transformer_encoder_11_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.11.self_attn.out_proj.weight]
    %_0_transformer_encoder_11_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.11.self_attn.out_proj.bias]
    %linear_epsilon_45 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_11, %_0_transformer_encoder_11_self_attn_out_proj_weight, %_0_transformer_encoder_11_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_11_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.11.deepnorm_alpha]
    %detach_34 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_11_deepnorm_alpha,), kwargs = {})
    %mul_68 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_34, %rms_norm_identity_custom_21), kwargs = {})
    %add_45 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_45, %mul_68), kwargs = {})
    %_0_transformer_encoder_11_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.11.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_22 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_22 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_45, %_0_transformer_encoder_11_norm1_scale, %_0_transformer_encoder_17_norm2_eps_22, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_11_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.11.ff.fc1.weight]
    %linear_epsilon_46 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_22, %_0_transformer_encoder_11_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_11 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_46, 2), kwargs = {dim: -1})
    %getitem_166 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_11, 0), kwargs = {})
    %getitem_167 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_11, 1), kwargs = {})
    %mul_69 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_167, %getitem_166), kwargs = {})
    %mul_70 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_69, 1), kwargs = {})
    %neg_11 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_167,), kwargs = {})
    %exp_11 : [num_users=1] = call_function[target=torch.exp](args = (%neg_11,), kwargs = {})
    %_tensor_constant35 : [num_users=1] = get_attr[target=_tensor_constant35]
    %add_46 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant35, %exp_11), kwargs = {})
    %truediv_23 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_70, %add_46), kwargs = {})
    %_0_transformer_encoder_11_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.11.ff.fc2.weight]
    %linear_epsilon_47 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_23, %_0_transformer_encoder_11_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_35 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_11_deepnorm_alpha,), kwargs = {})
    %mul_71 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_35, %rms_norm_identity_custom_22), kwargs = {})
    %add_47 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_47, %mul_71), kwargs = {})
    %_0_transformer_encoder_11_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.11.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_23 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_23 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_47, %_0_transformer_encoder_11_norm2_scale, %_0_transformer_encoder_17_norm2_eps_23, 512, -1.0, False), kwargs = {})
    %size_84 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_23,), kwargs = {})
    %getitem_168 : [num_users=2] = call_function[target=operator.getitem](args = (%size_84, 0), kwargs = {})
    %getitem_169 : [num_users=2] = call_function[target=operator.getitem](args = (%size_84, 1), kwargs = {})
    %getitem_170 : [num_users=0] = call_function[target=operator.getitem](args = (%size_84, 2), kwargs = {})
    %_0_transformer_encoder_12_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.12.self_attn.Wqkv.weight]
    %linear_epsilon_48 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_23, %_0_transformer_encoder_12_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_12 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_48, %getitem_168, %getitem_169, 3, 8, 64), kwargs = {})
    %getitem_171 : [num_users=3] = call_function[target=operator.getitem](args = (%view_12, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_172 : [num_users=3] = call_function[target=operator.getitem](args = (%view_12, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_173 : [num_users=1] = call_function[target=operator.getitem](args = (%view_12, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_85 : [num_users=1] = call_method[target=size](args = (%getitem_171,), kwargs = {})
    %getitem_174 : [num_users=1] = call_function[target=operator.getitem](args = (%size_85, 1), kwargs = {})
    %arange_24 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_174,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_12_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.12.self_attn.rotary_emb_flash.inv_freq]
    %getattr_85 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_12_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_24 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_85, torch.float32), kwargs = {})
    %_tensor_constant36 : [num_users=1] = get_attr[target=_tensor_constant36]
    %outer_24 : [num_users=2] = call_function[target=torch.outer](args = (%arange_24, %_tensor_constant36), kwargs = {})
    %cos_24 : [num_users=1] = call_function[target=torch.cos](args = (%outer_24,), kwargs = {})
    %getattr_86 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_171, dtype), kwargs = {})
    %to_72 : [num_users=1] = call_method[target=to](args = (%cos_24, %getattr_86), kwargs = {})
    %sin_24 : [num_users=1] = call_function[target=torch.sin](args = (%outer_24,), kwargs = {})
    %to_73 : [num_users=1] = call_method[target=to](args = (%sin_24, %getattr_86), kwargs = {})
    %apply_rotary_emb_torch_24 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_171, %to_72, %to_73, False), kwargs = {})
    %size_86 : [num_users=1] = call_method[target=size](args = (%getitem_172,), kwargs = {})
    %getitem_175 : [num_users=1] = call_function[target=operator.getitem](args = (%size_86, 1), kwargs = {})
    %arange_25 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_175,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_87 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_12_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_25 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_87, torch.float32), kwargs = {})
    %_tensor_constant37 : [num_users=1] = get_attr[target=_tensor_constant37]
    %outer_25 : [num_users=2] = call_function[target=torch.outer](args = (%arange_25, %_tensor_constant37), kwargs = {})
    %cos_25 : [num_users=1] = call_function[target=torch.cos](args = (%outer_25,), kwargs = {})
    %getattr_88 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_172, dtype), kwargs = {})
    %to_74 : [num_users=1] = call_method[target=to](args = (%cos_25, %getattr_88), kwargs = {})
    %sin_25 : [num_users=1] = call_function[target=torch.sin](args = (%outer_25,), kwargs = {})
    %to_75 : [num_users=1] = call_method[target=to](args = (%sin_25, %getattr_88), kwargs = {})
    %apply_rotary_emb_torch_25 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_172, %to_74, %to_75, False), kwargs = {})
    %size_87 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_24,), kwargs = {})
    %getitem_176 : [num_users=1] = call_function[target=operator.getitem](args = (%size_87, 1), kwargs = {})
    %full_12 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_176, %getitem_176),), kwargs = {fill_value: 1.0})
    %triu_12 : [num_users=2] = call_function[target=torch.triu](args = (%full_12,), kwargs = {diagonal: -127})
    %tril_12 : [num_users=1] = call_function[target=torch.tril](args = (%triu_12,), kwargs = {diagonal: 128})
    %mul_72 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_12, %tril_12), kwargs = {})
    %to_76 : [num_users=1] = call_method[target=to](args = (%mul_72, torch.bool), kwargs = {})
    %getattr_89 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_24, device), kwargs = {})
    %to_77 : [num_users=1] = call_method[target=to](args = (%to_76, %getattr_89), kwargs = {})
    %permute_49 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_24, 0, 2, 1, 3), kwargs = {})
    %getitem_177 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_49, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_50 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_25, 0, 2, 1, 3), kwargs = {})
    %getitem_178 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_50, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_51 : [num_users=1] = call_method[target=permute](args = (%getitem_173, 0, 2, 1, 3), kwargs = {})
    %getitem_179 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_51, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_88 : [num_users=1] = call_method[target=size](args = (%getitem_177, -2), kwargs = {})
    %size_89 : [num_users=1] = call_method[target=size](args = (%getitem_178, -2), kwargs = {})
    %size_90 : [num_users=1] = call_method[target=size](args = (%getitem_177, -1), kwargs = {})
    %sqrt_12 : [num_users=1] = call_function[target=math.sqrt](args = (%size_90,), kwargs = {})
    %truediv_24 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_12), kwargs = {})
    %getattr_90 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_177, dtype), kwargs = {})
    %getattr_91 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_177, device), kwargs = {})
    %zeros_12 : [num_users=2] = call_function[target=torch.zeros](args = (%size_88, %size_89), kwargs = {dtype: %getattr_90, device: %getattr_91})
    %logical_not_12 : [num_users=1] = call_method[target=logical_not](args = (%to_77,), kwargs = {})
    %masked_fill__12 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_12, %logical_not_12, -inf), kwargs = {})
    %transpose_12 : [num_users=1] = call_method[target=transpose](args = (%getitem_178, -2, -1), kwargs = {})
    %matmul_24 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_177, %transpose_12), kwargs = {})
    %tensor_12 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_24,), kwargs = {requires_grad: False})
    %mul_73 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_24, %tensor_12), kwargs = {})
    %detach_36 : [num_users=1] = call_method[target=detach](args = (%zeros_12,), kwargs = {})
    %add_48 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_73, %detach_36), kwargs = {})
    %softmax_12 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_48,), kwargs = {dim: -1})
    %matmul_25 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_12, %getitem_179), kwargs = {})
    %permute_52 : [num_users=1] = call_method[target=permute](args = (%matmul_25, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_12 : [num_users=1] = call_method[target=reshape](args = (%permute_52, %getitem_168, %getitem_169, 512), kwargs = {})
    %_0_transformer_encoder_12_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.12.self_attn.out_proj.weight]
    %_0_transformer_encoder_12_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.12.self_attn.out_proj.bias]
    %linear_epsilon_49 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_12, %_0_transformer_encoder_12_self_attn_out_proj_weight, %_0_transformer_encoder_12_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_12_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.12.deepnorm_alpha]
    %detach_37 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_12_deepnorm_alpha,), kwargs = {})
    %mul_74 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_37, %rms_norm_identity_custom_23), kwargs = {})
    %add_49 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_49, %mul_74), kwargs = {})
    %_0_transformer_encoder_12_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.12.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_24 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_24 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_49, %_0_transformer_encoder_12_norm1_scale, %_0_transformer_encoder_17_norm2_eps_24, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_12_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.12.ff.fc1.weight]
    %linear_epsilon_50 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_24, %_0_transformer_encoder_12_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_12 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_50, 2), kwargs = {dim: -1})
    %getitem_180 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_12, 0), kwargs = {})
    %getitem_181 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_12, 1), kwargs = {})
    %mul_75 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_181, %getitem_180), kwargs = {})
    %mul_76 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_75, 1), kwargs = {})
    %neg_12 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_181,), kwargs = {})
    %exp_12 : [num_users=1] = call_function[target=torch.exp](args = (%neg_12,), kwargs = {})
    %_tensor_constant38 : [num_users=1] = get_attr[target=_tensor_constant38]
    %add_50 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant38, %exp_12), kwargs = {})
    %truediv_25 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_76, %add_50), kwargs = {})
    %_0_transformer_encoder_12_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.12.ff.fc2.weight]
    %linear_epsilon_51 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_25, %_0_transformer_encoder_12_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_38 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_12_deepnorm_alpha,), kwargs = {})
    %mul_77 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_38, %rms_norm_identity_custom_24), kwargs = {})
    %add_51 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_51, %mul_77), kwargs = {})
    %_0_transformer_encoder_12_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.12.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_25 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_25 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_51, %_0_transformer_encoder_12_norm2_scale, %_0_transformer_encoder_17_norm2_eps_25, 512, -1.0, False), kwargs = {})
    %size_91 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_25,), kwargs = {})
    %getitem_182 : [num_users=2] = call_function[target=operator.getitem](args = (%size_91, 0), kwargs = {})
    %getitem_183 : [num_users=2] = call_function[target=operator.getitem](args = (%size_91, 1), kwargs = {})
    %getitem_184 : [num_users=0] = call_function[target=operator.getitem](args = (%size_91, 2), kwargs = {})
    %_0_transformer_encoder_13_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.13.self_attn.Wqkv.weight]
    %linear_epsilon_52 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_25, %_0_transformer_encoder_13_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_13 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_52, %getitem_182, %getitem_183, 3, 8, 64), kwargs = {})
    %getitem_185 : [num_users=3] = call_function[target=operator.getitem](args = (%view_13, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_186 : [num_users=3] = call_function[target=operator.getitem](args = (%view_13, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_187 : [num_users=1] = call_function[target=operator.getitem](args = (%view_13, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_92 : [num_users=1] = call_method[target=size](args = (%getitem_185,), kwargs = {})
    %getitem_188 : [num_users=1] = call_function[target=operator.getitem](args = (%size_92, 1), kwargs = {})
    %arange_26 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_188,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_13_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.13.self_attn.rotary_emb_flash.inv_freq]
    %getattr_92 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_13_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_26 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_92, torch.float32), kwargs = {})
    %_tensor_constant39 : [num_users=1] = get_attr[target=_tensor_constant39]
    %outer_26 : [num_users=2] = call_function[target=torch.outer](args = (%arange_26, %_tensor_constant39), kwargs = {})
    %cos_26 : [num_users=1] = call_function[target=torch.cos](args = (%outer_26,), kwargs = {})
    %getattr_93 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_185, dtype), kwargs = {})
    %to_78 : [num_users=1] = call_method[target=to](args = (%cos_26, %getattr_93), kwargs = {})
    %sin_26 : [num_users=1] = call_function[target=torch.sin](args = (%outer_26,), kwargs = {})
    %to_79 : [num_users=1] = call_method[target=to](args = (%sin_26, %getattr_93), kwargs = {})
    %apply_rotary_emb_torch_26 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_185, %to_78, %to_79, False), kwargs = {})
    %size_93 : [num_users=1] = call_method[target=size](args = (%getitem_186,), kwargs = {})
    %getitem_189 : [num_users=1] = call_function[target=operator.getitem](args = (%size_93, 1), kwargs = {})
    %arange_27 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_189,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_94 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_13_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_27 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_94, torch.float32), kwargs = {})
    %_tensor_constant40 : [num_users=1] = get_attr[target=_tensor_constant40]
    %outer_27 : [num_users=2] = call_function[target=torch.outer](args = (%arange_27, %_tensor_constant40), kwargs = {})
    %cos_27 : [num_users=1] = call_function[target=torch.cos](args = (%outer_27,), kwargs = {})
    %getattr_95 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_186, dtype), kwargs = {})
    %to_80 : [num_users=1] = call_method[target=to](args = (%cos_27, %getattr_95), kwargs = {})
    %sin_27 : [num_users=1] = call_function[target=torch.sin](args = (%outer_27,), kwargs = {})
    %to_81 : [num_users=1] = call_method[target=to](args = (%sin_27, %getattr_95), kwargs = {})
    %apply_rotary_emb_torch_27 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_186, %to_80, %to_81, False), kwargs = {})
    %size_94 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_26,), kwargs = {})
    %getitem_190 : [num_users=1] = call_function[target=operator.getitem](args = (%size_94, 1), kwargs = {})
    %full_13 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_190, %getitem_190),), kwargs = {fill_value: 1.0})
    %triu_13 : [num_users=2] = call_function[target=torch.triu](args = (%full_13,), kwargs = {diagonal: -127})
    %tril_13 : [num_users=1] = call_function[target=torch.tril](args = (%triu_13,), kwargs = {diagonal: 128})
    %mul_78 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_13, %tril_13), kwargs = {})
    %to_82 : [num_users=1] = call_method[target=to](args = (%mul_78, torch.bool), kwargs = {})
    %getattr_96 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_26, device), kwargs = {})
    %to_83 : [num_users=1] = call_method[target=to](args = (%to_82, %getattr_96), kwargs = {})
    %permute_53 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_26, 0, 2, 1, 3), kwargs = {})
    %getitem_191 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_53, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_54 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_27, 0, 2, 1, 3), kwargs = {})
    %getitem_192 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_54, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_55 : [num_users=1] = call_method[target=permute](args = (%getitem_187, 0, 2, 1, 3), kwargs = {})
    %getitem_193 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_55, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_95 : [num_users=1] = call_method[target=size](args = (%getitem_191, -2), kwargs = {})
    %size_96 : [num_users=1] = call_method[target=size](args = (%getitem_192, -2), kwargs = {})
    %size_97 : [num_users=1] = call_method[target=size](args = (%getitem_191, -1), kwargs = {})
    %sqrt_13 : [num_users=1] = call_function[target=math.sqrt](args = (%size_97,), kwargs = {})
    %truediv_26 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_13), kwargs = {})
    %getattr_97 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_191, dtype), kwargs = {})
    %getattr_98 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_191, device), kwargs = {})
    %zeros_13 : [num_users=2] = call_function[target=torch.zeros](args = (%size_95, %size_96), kwargs = {dtype: %getattr_97, device: %getattr_98})
    %logical_not_13 : [num_users=1] = call_method[target=logical_not](args = (%to_83,), kwargs = {})
    %masked_fill__13 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_13, %logical_not_13, -inf), kwargs = {})
    %transpose_13 : [num_users=1] = call_method[target=transpose](args = (%getitem_192, -2, -1), kwargs = {})
    %matmul_26 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_191, %transpose_13), kwargs = {})
    %tensor_13 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_26,), kwargs = {requires_grad: False})
    %mul_79 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_26, %tensor_13), kwargs = {})
    %detach_39 : [num_users=1] = call_method[target=detach](args = (%zeros_13,), kwargs = {})
    %add_52 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_79, %detach_39), kwargs = {})
    %softmax_13 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_52,), kwargs = {dim: -1})
    %matmul_27 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_13, %getitem_193), kwargs = {})
    %permute_56 : [num_users=1] = call_method[target=permute](args = (%matmul_27, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_13 : [num_users=1] = call_method[target=reshape](args = (%permute_56, %getitem_182, %getitem_183, 512), kwargs = {})
    %_0_transformer_encoder_13_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.13.self_attn.out_proj.weight]
    %_0_transformer_encoder_13_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.13.self_attn.out_proj.bias]
    %linear_epsilon_53 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_13, %_0_transformer_encoder_13_self_attn_out_proj_weight, %_0_transformer_encoder_13_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_13_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.13.deepnorm_alpha]
    %detach_40 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_13_deepnorm_alpha,), kwargs = {})
    %mul_80 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_40, %rms_norm_identity_custom_25), kwargs = {})
    %add_53 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_53, %mul_80), kwargs = {})
    %_0_transformer_encoder_13_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.13.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_26 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_26 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_53, %_0_transformer_encoder_13_norm1_scale, %_0_transformer_encoder_17_norm2_eps_26, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_13_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.13.ff.fc1.weight]
    %linear_epsilon_54 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_26, %_0_transformer_encoder_13_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_13 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_54, 2), kwargs = {dim: -1})
    %getitem_194 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_13, 0), kwargs = {})
    %getitem_195 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_13, 1), kwargs = {})
    %mul_81 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_195, %getitem_194), kwargs = {})
    %mul_82 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_81, 1), kwargs = {})
    %neg_13 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_195,), kwargs = {})
    %exp_13 : [num_users=1] = call_function[target=torch.exp](args = (%neg_13,), kwargs = {})
    %_tensor_constant41 : [num_users=1] = get_attr[target=_tensor_constant41]
    %add_54 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant41, %exp_13), kwargs = {})
    %truediv_27 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_82, %add_54), kwargs = {})
    %_0_transformer_encoder_13_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.13.ff.fc2.weight]
    %linear_epsilon_55 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_27, %_0_transformer_encoder_13_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_41 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_13_deepnorm_alpha,), kwargs = {})
    %mul_83 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_41, %rms_norm_identity_custom_26), kwargs = {})
    %add_55 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_55, %mul_83), kwargs = {})
    %_0_transformer_encoder_13_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.13.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_27 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_27 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_55, %_0_transformer_encoder_13_norm2_scale, %_0_transformer_encoder_17_norm2_eps_27, 512, -1.0, False), kwargs = {})
    %size_98 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_27,), kwargs = {})
    %getitem_196 : [num_users=2] = call_function[target=operator.getitem](args = (%size_98, 0), kwargs = {})
    %getitem_197 : [num_users=2] = call_function[target=operator.getitem](args = (%size_98, 1), kwargs = {})
    %getitem_198 : [num_users=0] = call_function[target=operator.getitem](args = (%size_98, 2), kwargs = {})
    %_0_transformer_encoder_14_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.14.self_attn.Wqkv.weight]
    %linear_epsilon_56 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_27, %_0_transformer_encoder_14_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_14 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_56, %getitem_196, %getitem_197, 3, 8, 64), kwargs = {})
    %getitem_199 : [num_users=3] = call_function[target=operator.getitem](args = (%view_14, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_200 : [num_users=3] = call_function[target=operator.getitem](args = (%view_14, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_201 : [num_users=1] = call_function[target=operator.getitem](args = (%view_14, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_99 : [num_users=1] = call_method[target=size](args = (%getitem_199,), kwargs = {})
    %getitem_202 : [num_users=1] = call_function[target=operator.getitem](args = (%size_99, 1), kwargs = {})
    %arange_28 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_202,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_14_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.14.self_attn.rotary_emb_flash.inv_freq]
    %getattr_99 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_14_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_28 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_99, torch.float32), kwargs = {})
    %_tensor_constant42 : [num_users=1] = get_attr[target=_tensor_constant42]
    %outer_28 : [num_users=2] = call_function[target=torch.outer](args = (%arange_28, %_tensor_constant42), kwargs = {})
    %cos_28 : [num_users=1] = call_function[target=torch.cos](args = (%outer_28,), kwargs = {})
    %getattr_100 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_199, dtype), kwargs = {})
    %to_84 : [num_users=1] = call_method[target=to](args = (%cos_28, %getattr_100), kwargs = {})
    %sin_28 : [num_users=1] = call_function[target=torch.sin](args = (%outer_28,), kwargs = {})
    %to_85 : [num_users=1] = call_method[target=to](args = (%sin_28, %getattr_100), kwargs = {})
    %apply_rotary_emb_torch_28 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_199, %to_84, %to_85, False), kwargs = {})
    %size_100 : [num_users=1] = call_method[target=size](args = (%getitem_200,), kwargs = {})
    %getitem_203 : [num_users=1] = call_function[target=operator.getitem](args = (%size_100, 1), kwargs = {})
    %arange_29 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_203,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_101 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_14_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_29 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_101, torch.float32), kwargs = {})
    %_tensor_constant43 : [num_users=1] = get_attr[target=_tensor_constant43]
    %outer_29 : [num_users=2] = call_function[target=torch.outer](args = (%arange_29, %_tensor_constant43), kwargs = {})
    %cos_29 : [num_users=1] = call_function[target=torch.cos](args = (%outer_29,), kwargs = {})
    %getattr_102 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_200, dtype), kwargs = {})
    %to_86 : [num_users=1] = call_method[target=to](args = (%cos_29, %getattr_102), kwargs = {})
    %sin_29 : [num_users=1] = call_function[target=torch.sin](args = (%outer_29,), kwargs = {})
    %to_87 : [num_users=1] = call_method[target=to](args = (%sin_29, %getattr_102), kwargs = {})
    %apply_rotary_emb_torch_29 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_200, %to_86, %to_87, False), kwargs = {})
    %size_101 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_28,), kwargs = {})
    %getitem_204 : [num_users=1] = call_function[target=operator.getitem](args = (%size_101, 1), kwargs = {})
    %full_14 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_204, %getitem_204),), kwargs = {fill_value: 1.0})
    %triu_14 : [num_users=2] = call_function[target=torch.triu](args = (%full_14,), kwargs = {diagonal: -127})
    %tril_14 : [num_users=1] = call_function[target=torch.tril](args = (%triu_14,), kwargs = {diagonal: 128})
    %mul_84 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_14, %tril_14), kwargs = {})
    %to_88 : [num_users=1] = call_method[target=to](args = (%mul_84, torch.bool), kwargs = {})
    %getattr_103 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_28, device), kwargs = {})
    %to_89 : [num_users=1] = call_method[target=to](args = (%to_88, %getattr_103), kwargs = {})
    %permute_57 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_28, 0, 2, 1, 3), kwargs = {})
    %getitem_205 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_57, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_58 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_29, 0, 2, 1, 3), kwargs = {})
    %getitem_206 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_58, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_59 : [num_users=1] = call_method[target=permute](args = (%getitem_201, 0, 2, 1, 3), kwargs = {})
    %getitem_207 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_59, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_102 : [num_users=1] = call_method[target=size](args = (%getitem_205, -2), kwargs = {})
    %size_103 : [num_users=1] = call_method[target=size](args = (%getitem_206, -2), kwargs = {})
    %size_104 : [num_users=1] = call_method[target=size](args = (%getitem_205, -1), kwargs = {})
    %sqrt_14 : [num_users=1] = call_function[target=math.sqrt](args = (%size_104,), kwargs = {})
    %truediv_28 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_14), kwargs = {})
    %getattr_104 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_205, dtype), kwargs = {})
    %getattr_105 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_205, device), kwargs = {})
    %zeros_14 : [num_users=2] = call_function[target=torch.zeros](args = (%size_102, %size_103), kwargs = {dtype: %getattr_104, device: %getattr_105})
    %logical_not_14 : [num_users=1] = call_method[target=logical_not](args = (%to_89,), kwargs = {})
    %masked_fill__14 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_14, %logical_not_14, -inf), kwargs = {})
    %transpose_14 : [num_users=1] = call_method[target=transpose](args = (%getitem_206, -2, -1), kwargs = {})
    %matmul_28 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_205, %transpose_14), kwargs = {})
    %tensor_14 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_28,), kwargs = {requires_grad: False})
    %mul_85 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_28, %tensor_14), kwargs = {})
    %detach_42 : [num_users=1] = call_method[target=detach](args = (%zeros_14,), kwargs = {})
    %add_56 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_85, %detach_42), kwargs = {})
    %softmax_14 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_56,), kwargs = {dim: -1})
    %matmul_29 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_14, %getitem_207), kwargs = {})
    %permute_60 : [num_users=1] = call_method[target=permute](args = (%matmul_29, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_14 : [num_users=1] = call_method[target=reshape](args = (%permute_60, %getitem_196, %getitem_197, 512), kwargs = {})
    %_0_transformer_encoder_14_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.14.self_attn.out_proj.weight]
    %_0_transformer_encoder_14_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.14.self_attn.out_proj.bias]
    %linear_epsilon_57 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_14, %_0_transformer_encoder_14_self_attn_out_proj_weight, %_0_transformer_encoder_14_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_14_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.14.deepnorm_alpha]
    %detach_43 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_14_deepnorm_alpha,), kwargs = {})
    %mul_86 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_43, %rms_norm_identity_custom_27), kwargs = {})
    %add_57 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_57, %mul_86), kwargs = {})
    %_0_transformer_encoder_14_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.14.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_28 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_28 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_57, %_0_transformer_encoder_14_norm1_scale, %_0_transformer_encoder_17_norm2_eps_28, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_14_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.14.ff.fc1.weight]
    %linear_epsilon_58 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_28, %_0_transformer_encoder_14_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_14 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_58, 2), kwargs = {dim: -1})
    %getitem_208 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_14, 0), kwargs = {})
    %getitem_209 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_14, 1), kwargs = {})
    %mul_87 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_209, %getitem_208), kwargs = {})
    %mul_88 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_87, 1), kwargs = {})
    %neg_14 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_209,), kwargs = {})
    %exp_14 : [num_users=1] = call_function[target=torch.exp](args = (%neg_14,), kwargs = {})
    %_tensor_constant44 : [num_users=1] = get_attr[target=_tensor_constant44]
    %add_58 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant44, %exp_14), kwargs = {})
    %truediv_29 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_88, %add_58), kwargs = {})
    %_0_transformer_encoder_14_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.14.ff.fc2.weight]
    %linear_epsilon_59 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_29, %_0_transformer_encoder_14_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_44 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_14_deepnorm_alpha,), kwargs = {})
    %mul_89 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_44, %rms_norm_identity_custom_28), kwargs = {})
    %add_59 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_59, %mul_89), kwargs = {})
    %_0_transformer_encoder_14_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.14.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_29 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_29 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_59, %_0_transformer_encoder_14_norm2_scale, %_0_transformer_encoder_17_norm2_eps_29, 512, -1.0, False), kwargs = {})
    %size_105 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_29,), kwargs = {})
    %getitem_210 : [num_users=2] = call_function[target=operator.getitem](args = (%size_105, 0), kwargs = {})
    %getitem_211 : [num_users=2] = call_function[target=operator.getitem](args = (%size_105, 1), kwargs = {})
    %getitem_212 : [num_users=0] = call_function[target=operator.getitem](args = (%size_105, 2), kwargs = {})
    %_0_transformer_encoder_15_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.15.self_attn.Wqkv.weight]
    %linear_epsilon_60 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_29, %_0_transformer_encoder_15_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_15 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_60, %getitem_210, %getitem_211, 3, 8, 64), kwargs = {})
    %getitem_213 : [num_users=3] = call_function[target=operator.getitem](args = (%view_15, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_214 : [num_users=3] = call_function[target=operator.getitem](args = (%view_15, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_215 : [num_users=1] = call_function[target=operator.getitem](args = (%view_15, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_106 : [num_users=1] = call_method[target=size](args = (%getitem_213,), kwargs = {})
    %getitem_216 : [num_users=1] = call_function[target=operator.getitem](args = (%size_106, 1), kwargs = {})
    %arange_30 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_216,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_15_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.15.self_attn.rotary_emb_flash.inv_freq]
    %getattr_106 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_15_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_30 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_106, torch.float32), kwargs = {})
    %_tensor_constant45 : [num_users=1] = get_attr[target=_tensor_constant45]
    %outer_30 : [num_users=2] = call_function[target=torch.outer](args = (%arange_30, %_tensor_constant45), kwargs = {})
    %cos_30 : [num_users=1] = call_function[target=torch.cos](args = (%outer_30,), kwargs = {})
    %getattr_107 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_213, dtype), kwargs = {})
    %to_90 : [num_users=1] = call_method[target=to](args = (%cos_30, %getattr_107), kwargs = {})
    %sin_30 : [num_users=1] = call_function[target=torch.sin](args = (%outer_30,), kwargs = {})
    %to_91 : [num_users=1] = call_method[target=to](args = (%sin_30, %getattr_107), kwargs = {})
    %apply_rotary_emb_torch_30 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_213, %to_90, %to_91, False), kwargs = {})
    %size_107 : [num_users=1] = call_method[target=size](args = (%getitem_214,), kwargs = {})
    %getitem_217 : [num_users=1] = call_function[target=operator.getitem](args = (%size_107, 1), kwargs = {})
    %arange_31 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_217,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_108 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_15_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_31 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_108, torch.float32), kwargs = {})
    %_tensor_constant46 : [num_users=1] = get_attr[target=_tensor_constant46]
    %outer_31 : [num_users=2] = call_function[target=torch.outer](args = (%arange_31, %_tensor_constant46), kwargs = {})
    %cos_31 : [num_users=1] = call_function[target=torch.cos](args = (%outer_31,), kwargs = {})
    %getattr_109 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_214, dtype), kwargs = {})
    %to_92 : [num_users=1] = call_method[target=to](args = (%cos_31, %getattr_109), kwargs = {})
    %sin_31 : [num_users=1] = call_function[target=torch.sin](args = (%outer_31,), kwargs = {})
    %to_93 : [num_users=1] = call_method[target=to](args = (%sin_31, %getattr_109), kwargs = {})
    %apply_rotary_emb_torch_31 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_214, %to_92, %to_93, False), kwargs = {})
    %size_108 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_30,), kwargs = {})
    %getitem_218 : [num_users=1] = call_function[target=operator.getitem](args = (%size_108, 1), kwargs = {})
    %full_15 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_218, %getitem_218),), kwargs = {fill_value: 1.0})
    %triu_15 : [num_users=2] = call_function[target=torch.triu](args = (%full_15,), kwargs = {diagonal: -127})
    %tril_15 : [num_users=1] = call_function[target=torch.tril](args = (%triu_15,), kwargs = {diagonal: 128})
    %mul_90 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_15, %tril_15), kwargs = {})
    %to_94 : [num_users=1] = call_method[target=to](args = (%mul_90, torch.bool), kwargs = {})
    %getattr_110 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_30, device), kwargs = {})
    %to_95 : [num_users=1] = call_method[target=to](args = (%to_94, %getattr_110), kwargs = {})
    %permute_61 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_30, 0, 2, 1, 3), kwargs = {})
    %getitem_219 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_61, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_62 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_31, 0, 2, 1, 3), kwargs = {})
    %getitem_220 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_62, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_63 : [num_users=1] = call_method[target=permute](args = (%getitem_215, 0, 2, 1, 3), kwargs = {})
    %getitem_221 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_63, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_109 : [num_users=1] = call_method[target=size](args = (%getitem_219, -2), kwargs = {})
    %size_110 : [num_users=1] = call_method[target=size](args = (%getitem_220, -2), kwargs = {})
    %size_111 : [num_users=1] = call_method[target=size](args = (%getitem_219, -1), kwargs = {})
    %sqrt_15 : [num_users=1] = call_function[target=math.sqrt](args = (%size_111,), kwargs = {})
    %truediv_30 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_15), kwargs = {})
    %getattr_111 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_219, dtype), kwargs = {})
    %getattr_112 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_219, device), kwargs = {})
    %zeros_15 : [num_users=2] = call_function[target=torch.zeros](args = (%size_109, %size_110), kwargs = {dtype: %getattr_111, device: %getattr_112})
    %logical_not_15 : [num_users=1] = call_method[target=logical_not](args = (%to_95,), kwargs = {})
    %masked_fill__15 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_15, %logical_not_15, -inf), kwargs = {})
    %transpose_15 : [num_users=1] = call_method[target=transpose](args = (%getitem_220, -2, -1), kwargs = {})
    %matmul_30 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_219, %transpose_15), kwargs = {})
    %tensor_15 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_30,), kwargs = {requires_grad: False})
    %mul_91 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_30, %tensor_15), kwargs = {})
    %detach_45 : [num_users=1] = call_method[target=detach](args = (%zeros_15,), kwargs = {})
    %add_60 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_91, %detach_45), kwargs = {})
    %softmax_15 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_60,), kwargs = {dim: -1})
    %matmul_31 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_15, %getitem_221), kwargs = {})
    %permute_64 : [num_users=1] = call_method[target=permute](args = (%matmul_31, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_15 : [num_users=1] = call_method[target=reshape](args = (%permute_64, %getitem_210, %getitem_211, 512), kwargs = {})
    %_0_transformer_encoder_15_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.15.self_attn.out_proj.weight]
    %_0_transformer_encoder_15_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.15.self_attn.out_proj.bias]
    %linear_epsilon_61 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_15, %_0_transformer_encoder_15_self_attn_out_proj_weight, %_0_transformer_encoder_15_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_15_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.15.deepnorm_alpha]
    %detach_46 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_15_deepnorm_alpha,), kwargs = {})
    %mul_92 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_46, %rms_norm_identity_custom_29), kwargs = {})
    %add_61 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_61, %mul_92), kwargs = {})
    %_0_transformer_encoder_15_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.15.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_30 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_30 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_61, %_0_transformer_encoder_15_norm1_scale, %_0_transformer_encoder_17_norm2_eps_30, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_15_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.15.ff.fc1.weight]
    %linear_epsilon_62 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_30, %_0_transformer_encoder_15_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_15 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_62, 2), kwargs = {dim: -1})
    %getitem_222 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_15, 0), kwargs = {})
    %getitem_223 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_15, 1), kwargs = {})
    %mul_93 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_223, %getitem_222), kwargs = {})
    %mul_94 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_93, 1), kwargs = {})
    %neg_15 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_223,), kwargs = {})
    %exp_15 : [num_users=1] = call_function[target=torch.exp](args = (%neg_15,), kwargs = {})
    %_tensor_constant47 : [num_users=1] = get_attr[target=_tensor_constant47]
    %add_62 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant47, %exp_15), kwargs = {})
    %truediv_31 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_94, %add_62), kwargs = {})
    %_0_transformer_encoder_15_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.15.ff.fc2.weight]
    %linear_epsilon_63 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_31, %_0_transformer_encoder_15_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_47 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_15_deepnorm_alpha,), kwargs = {})
    %mul_95 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_47, %rms_norm_identity_custom_30), kwargs = {})
    %add_63 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_63, %mul_95), kwargs = {})
    %_0_transformer_encoder_15_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.15.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_31 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_31 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_63, %_0_transformer_encoder_15_norm2_scale, %_0_transformer_encoder_17_norm2_eps_31, 512, -1.0, False), kwargs = {})
    %size_112 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_31,), kwargs = {})
    %getitem_224 : [num_users=2] = call_function[target=operator.getitem](args = (%size_112, 0), kwargs = {})
    %getitem_225 : [num_users=2] = call_function[target=operator.getitem](args = (%size_112, 1), kwargs = {})
    %getitem_226 : [num_users=0] = call_function[target=operator.getitem](args = (%size_112, 2), kwargs = {})
    %_0_transformer_encoder_16_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.16.self_attn.Wqkv.weight]
    %linear_epsilon_64 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_31, %_0_transformer_encoder_16_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_16 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_64, %getitem_224, %getitem_225, 3, 8, 64), kwargs = {})
    %getitem_227 : [num_users=3] = call_function[target=operator.getitem](args = (%view_16, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_228 : [num_users=3] = call_function[target=operator.getitem](args = (%view_16, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_229 : [num_users=1] = call_function[target=operator.getitem](args = (%view_16, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_113 : [num_users=1] = call_method[target=size](args = (%getitem_227,), kwargs = {})
    %getitem_230 : [num_users=1] = call_function[target=operator.getitem](args = (%size_113, 1), kwargs = {})
    %arange_32 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_230,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_16_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.16.self_attn.rotary_emb_flash.inv_freq]
    %getattr_113 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_16_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_32 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_113, torch.float32), kwargs = {})
    %_tensor_constant48 : [num_users=1] = get_attr[target=_tensor_constant48]
    %outer_32 : [num_users=2] = call_function[target=torch.outer](args = (%arange_32, %_tensor_constant48), kwargs = {})
    %cos_32 : [num_users=1] = call_function[target=torch.cos](args = (%outer_32,), kwargs = {})
    %getattr_114 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_227, dtype), kwargs = {})
    %to_96 : [num_users=1] = call_method[target=to](args = (%cos_32, %getattr_114), kwargs = {})
    %sin_32 : [num_users=1] = call_function[target=torch.sin](args = (%outer_32,), kwargs = {})
    %to_97 : [num_users=1] = call_method[target=to](args = (%sin_32, %getattr_114), kwargs = {})
    %apply_rotary_emb_torch_32 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_227, %to_96, %to_97, False), kwargs = {})
    %size_114 : [num_users=1] = call_method[target=size](args = (%getitem_228,), kwargs = {})
    %getitem_231 : [num_users=1] = call_function[target=operator.getitem](args = (%size_114, 1), kwargs = {})
    %arange_33 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_231,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_115 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_16_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_33 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_115, torch.float32), kwargs = {})
    %_tensor_constant49 : [num_users=1] = get_attr[target=_tensor_constant49]
    %outer_33 : [num_users=2] = call_function[target=torch.outer](args = (%arange_33, %_tensor_constant49), kwargs = {})
    %cos_33 : [num_users=1] = call_function[target=torch.cos](args = (%outer_33,), kwargs = {})
    %getattr_116 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_228, dtype), kwargs = {})
    %to_98 : [num_users=1] = call_method[target=to](args = (%cos_33, %getattr_116), kwargs = {})
    %sin_33 : [num_users=1] = call_function[target=torch.sin](args = (%outer_33,), kwargs = {})
    %to_99 : [num_users=1] = call_method[target=to](args = (%sin_33, %getattr_116), kwargs = {})
    %apply_rotary_emb_torch_33 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_228, %to_98, %to_99, False), kwargs = {})
    %size_115 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_32,), kwargs = {})
    %getitem_232 : [num_users=1] = call_function[target=operator.getitem](args = (%size_115, 1), kwargs = {})
    %full_16 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_232, %getitem_232),), kwargs = {fill_value: 1.0})
    %triu_16 : [num_users=2] = call_function[target=torch.triu](args = (%full_16,), kwargs = {diagonal: -127})
    %tril_16 : [num_users=1] = call_function[target=torch.tril](args = (%triu_16,), kwargs = {diagonal: 128})
    %mul_96 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_16, %tril_16), kwargs = {})
    %to_100 : [num_users=1] = call_method[target=to](args = (%mul_96, torch.bool), kwargs = {})
    %getattr_117 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_32, device), kwargs = {})
    %to_101 : [num_users=1] = call_method[target=to](args = (%to_100, %getattr_117), kwargs = {})
    %permute_65 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_32, 0, 2, 1, 3), kwargs = {})
    %getitem_233 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_65, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_66 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_33, 0, 2, 1, 3), kwargs = {})
    %getitem_234 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_66, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_67 : [num_users=1] = call_method[target=permute](args = (%getitem_229, 0, 2, 1, 3), kwargs = {})
    %getitem_235 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_67, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_116 : [num_users=1] = call_method[target=size](args = (%getitem_233, -2), kwargs = {})
    %size_117 : [num_users=1] = call_method[target=size](args = (%getitem_234, -2), kwargs = {})
    %size_118 : [num_users=1] = call_method[target=size](args = (%getitem_233, -1), kwargs = {})
    %sqrt_16 : [num_users=1] = call_function[target=math.sqrt](args = (%size_118,), kwargs = {})
    %truediv_32 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_16), kwargs = {})
    %getattr_118 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_233, dtype), kwargs = {})
    %getattr_119 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_233, device), kwargs = {})
    %zeros_16 : [num_users=2] = call_function[target=torch.zeros](args = (%size_116, %size_117), kwargs = {dtype: %getattr_118, device: %getattr_119})
    %logical_not_16 : [num_users=1] = call_method[target=logical_not](args = (%to_101,), kwargs = {})
    %masked_fill__16 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_16, %logical_not_16, -inf), kwargs = {})
    %transpose_16 : [num_users=1] = call_method[target=transpose](args = (%getitem_234, -2, -1), kwargs = {})
    %matmul_32 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_233, %transpose_16), kwargs = {})
    %tensor_16 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_32,), kwargs = {requires_grad: False})
    %mul_97 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_32, %tensor_16), kwargs = {})
    %detach_48 : [num_users=1] = call_method[target=detach](args = (%zeros_16,), kwargs = {})
    %add_64 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_97, %detach_48), kwargs = {})
    %softmax_16 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_64,), kwargs = {dim: -1})
    %matmul_33 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_16, %getitem_235), kwargs = {})
    %permute_68 : [num_users=1] = call_method[target=permute](args = (%matmul_33, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_16 : [num_users=1] = call_method[target=reshape](args = (%permute_68, %getitem_224, %getitem_225, 512), kwargs = {})
    %_0_transformer_encoder_16_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.16.self_attn.out_proj.weight]
    %_0_transformer_encoder_16_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.16.self_attn.out_proj.bias]
    %linear_epsilon_65 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_16, %_0_transformer_encoder_16_self_attn_out_proj_weight, %_0_transformer_encoder_16_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_16_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.16.deepnorm_alpha]
    %detach_49 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_16_deepnorm_alpha,), kwargs = {})
    %mul_98 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_49, %rms_norm_identity_custom_31), kwargs = {})
    %add_65 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_65, %mul_98), kwargs = {})
    %_0_transformer_encoder_16_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.16.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_32 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_32 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_65, %_0_transformer_encoder_16_norm1_scale, %_0_transformer_encoder_17_norm2_eps_32, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_16_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.16.ff.fc1.weight]
    %linear_epsilon_66 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_32, %_0_transformer_encoder_16_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_16 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_66, 2), kwargs = {dim: -1})
    %getitem_236 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_16, 0), kwargs = {})
    %getitem_237 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_16, 1), kwargs = {})
    %mul_99 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_237, %getitem_236), kwargs = {})
    %mul_100 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_99, 1), kwargs = {})
    %neg_16 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_237,), kwargs = {})
    %exp_16 : [num_users=1] = call_function[target=torch.exp](args = (%neg_16,), kwargs = {})
    %_tensor_constant50 : [num_users=1] = get_attr[target=_tensor_constant50]
    %add_66 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant50, %exp_16), kwargs = {})
    %truediv_33 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_100, %add_66), kwargs = {})
    %_0_transformer_encoder_16_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.16.ff.fc2.weight]
    %linear_epsilon_67 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_33, %_0_transformer_encoder_16_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_50 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_16_deepnorm_alpha,), kwargs = {})
    %mul_101 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_50, %rms_norm_identity_custom_32), kwargs = {})
    %add_67 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_67, %mul_101), kwargs = {})
    %_0_transformer_encoder_16_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.16.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_33 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_33 : [num_users=3] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_67, %_0_transformer_encoder_16_norm2_scale, %_0_transformer_encoder_17_norm2_eps_33, 512, -1.0, False), kwargs = {})
    %size_119 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_33,), kwargs = {})
    %getitem_238 : [num_users=2] = call_function[target=operator.getitem](args = (%size_119, 0), kwargs = {})
    %getitem_239 : [num_users=2] = call_function[target=operator.getitem](args = (%size_119, 1), kwargs = {})
    %getitem_240 : [num_users=0] = call_function[target=operator.getitem](args = (%size_119, 2), kwargs = {})
    %_0_transformer_encoder_17_self_attn_wqkv_weight : [num_users=1] = get_attr[target=0.transformer_encoder.17.self_attn.Wqkv.weight]
    %linear_epsilon_68 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_33, %_0_transformer_encoder_17_self_attn_wqkv_weight, None, 1e-06), kwargs = {})
    %view_17 : [num_users=3] = call_method[target=view](args = (%linear_epsilon_68, %getitem_238, %getitem_239, 3, 8, 64), kwargs = {})
    %getitem_241 : [num_users=3] = call_function[target=operator.getitem](args = (%view_17, (slice(None, None, None), slice(None, None, None), 0, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_242 : [num_users=3] = call_function[target=operator.getitem](args = (%view_17, (slice(None, None, None), slice(None, None, None), 1, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %getitem_243 : [num_users=1] = call_function[target=operator.getitem](args = (%view_17, (slice(None, None, None), slice(None, None, None), 2, slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_120 : [num_users=1] = call_method[target=size](args = (%getitem_241,), kwargs = {})
    %getitem_244 : [num_users=1] = call_function[target=operator.getitem](args = (%size_120, 1), kwargs = {})
    %arange_34 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_244,), kwargs = {device: cuda, dtype: torch.float32})
    %_0_transformer_encoder_17_self_attn_rotary_emb_flash_inv_freq : [num_users=2] = get_attr[target=0.transformer_encoder.17.self_attn.rotary_emb_flash.inv_freq]
    %getattr_120 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_17_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_34 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_120, torch.float32), kwargs = {})
    %_tensor_constant51 : [num_users=1] = get_attr[target=_tensor_constant51]
    %outer_34 : [num_users=2] = call_function[target=torch.outer](args = (%arange_34, %_tensor_constant51), kwargs = {})
    %cos_34 : [num_users=1] = call_function[target=torch.cos](args = (%outer_34,), kwargs = {})
    %getattr_121 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_241, dtype), kwargs = {})
    %to_102 : [num_users=1] = call_method[target=to](args = (%cos_34, %getattr_121), kwargs = {})
    %sin_34 : [num_users=1] = call_function[target=torch.sin](args = (%outer_34,), kwargs = {})
    %to_103 : [num_users=1] = call_method[target=to](args = (%sin_34, %getattr_121), kwargs = {})
    %apply_rotary_emb_torch_34 : [num_users=3] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_241, %to_102, %to_103, False), kwargs = {})
    %size_121 : [num_users=1] = call_method[target=size](args = (%getitem_242,), kwargs = {})
    %getitem_245 : [num_users=1] = call_function[target=operator.getitem](args = (%size_121, 1), kwargs = {})
    %arange_35 : [num_users=1] = call_function[target=torch.arange](args = (%getitem_245,), kwargs = {device: cuda, dtype: torch.float32})
    %getattr_122 : [num_users=1] = call_function[target=builtins.getattr](args = (%_0_transformer_encoder_17_self_attn_rotary_emb_flash_inv_freq, dtype), kwargs = {})
    %ne_35 : [num_users=0] = call_function[target=operator.ne](args = (%getattr_122, torch.float32), kwargs = {})
    %_tensor_constant52 : [num_users=1] = get_attr[target=_tensor_constant52]
    %outer_35 : [num_users=2] = call_function[target=torch.outer](args = (%arange_35, %_tensor_constant52), kwargs = {})
    %cos_35 : [num_users=1] = call_function[target=torch.cos](args = (%outer_35,), kwargs = {})
    %getattr_123 : [num_users=2] = call_function[target=builtins.getattr](args = (%getitem_242, dtype), kwargs = {})
    %to_104 : [num_users=1] = call_method[target=to](args = (%cos_35, %getattr_123), kwargs = {})
    %sin_35 : [num_users=1] = call_function[target=torch.sin](args = (%outer_35,), kwargs = {})
    %to_105 : [num_users=1] = call_method[target=to](args = (%sin_35, %getattr_123), kwargs = {})
    %apply_rotary_emb_torch_35 : [num_users=1] = call_function[target=flash_attn.layers.rotary.apply_rotary_emb_torch](args = (%getitem_242, %to_104, %to_105, False), kwargs = {})
    %size_122 : [num_users=1] = call_method[target=size](args = (%apply_rotary_emb_torch_34,), kwargs = {})
    %getitem_246 : [num_users=1] = call_function[target=operator.getitem](args = (%size_122, 1), kwargs = {})
    %full_17 : [num_users=1] = call_function[target=torch.full](args = ((%getitem_246, %getitem_246),), kwargs = {fill_value: 1.0})
    %triu_17 : [num_users=2] = call_function[target=torch.triu](args = (%full_17,), kwargs = {diagonal: -127})
    %tril_17 : [num_users=1] = call_function[target=torch.tril](args = (%triu_17,), kwargs = {diagonal: 128})
    %mul_102 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%triu_17, %tril_17), kwargs = {})
    %to_106 : [num_users=1] = call_method[target=to](args = (%mul_102, torch.bool), kwargs = {})
    %getattr_124 : [num_users=1] = call_function[target=builtins.getattr](args = (%apply_rotary_emb_torch_34, device), kwargs = {})
    %to_107 : [num_users=1] = call_method[target=to](args = (%to_106, %getattr_124), kwargs = {})
    %permute_69 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_34, 0, 2, 1, 3), kwargs = {})
    %getitem_247 : [num_users=5] = call_function[target=operator.getitem](args = (%permute_69, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_70 : [num_users=1] = call_method[target=permute](args = (%apply_rotary_emb_torch_35, 0, 2, 1, 3), kwargs = {})
    %getitem_248 : [num_users=2] = call_function[target=operator.getitem](args = (%permute_70, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %permute_71 : [num_users=1] = call_method[target=permute](args = (%getitem_243, 0, 2, 1, 3), kwargs = {})
    %getitem_249 : [num_users=1] = call_function[target=operator.getitem](args = (%permute_71, (slice(None, None, None), None, slice(None, None, None), slice(None, None, None), slice(None, None, None))), kwargs = {})
    %size_123 : [num_users=1] = call_method[target=size](args = (%getitem_247, -2), kwargs = {})
    %size_124 : [num_users=1] = call_method[target=size](args = (%getitem_248, -2), kwargs = {})
    %size_125 : [num_users=1] = call_method[target=size](args = (%getitem_247, -1), kwargs = {})
    %sqrt_17 : [num_users=1] = call_function[target=math.sqrt](args = (%size_125,), kwargs = {})
    %truediv_34 : [num_users=1] = call_function[target=operator.truediv](args = (1, %sqrt_17), kwargs = {})
    %getattr_125 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_247, dtype), kwargs = {})
    %getattr_126 : [num_users=1] = call_function[target=builtins.getattr](args = (%getitem_247, device), kwargs = {})
    %zeros_17 : [num_users=2] = call_function[target=torch.zeros](args = (%size_123, %size_124), kwargs = {dtype: %getattr_125, device: %getattr_126})
    %logical_not_17 : [num_users=1] = call_method[target=logical_not](args = (%to_107,), kwargs = {})
    %masked_fill__17 : [num_users=0] = call_method[target=masked_fill_](args = (%zeros_17, %logical_not_17, -inf), kwargs = {})
    %transpose_17 : [num_users=1] = call_method[target=transpose](args = (%getitem_248, -2, -1), kwargs = {})
    %matmul_34 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%getitem_247, %transpose_17), kwargs = {})
    %tensor_17 : [num_users=1] = call_function[target=torch.tensor](args = (%truediv_34,), kwargs = {requires_grad: False})
    %mul_103 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%matmul_34, %tensor_17), kwargs = {})
    %detach_51 : [num_users=1] = call_method[target=detach](args = (%zeros_17,), kwargs = {})
    %add_68 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%mul_103, %detach_51), kwargs = {})
    %softmax_17 : [num_users=1] = call_function[target=lxt.functional.softmax](args = (%add_68,), kwargs = {dim: -1})
    %matmul_35 : [num_users=1] = call_function[target=lxt.functional.matmul](args = (%softmax_17, %getitem_249), kwargs = {})
    %permute_72 : [num_users=1] = call_method[target=permute](args = (%matmul_35, 0, 1, 3, 2, 4), kwargs = {})
    %reshape_17 : [num_users=1] = call_method[target=reshape](args = (%permute_72, %getitem_238, %getitem_239, 512), kwargs = {})
    %_0_transformer_encoder_17_self_attn_out_proj_weight : [num_users=1] = get_attr[target=0.transformer_encoder.17.self_attn.out_proj.weight]
    %_0_transformer_encoder_17_self_attn_out_proj_bias : [num_users=1] = get_attr[target=0.transformer_encoder.17.self_attn.out_proj.bias]
    %linear_epsilon_69 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%reshape_17, %_0_transformer_encoder_17_self_attn_out_proj_weight, %_0_transformer_encoder_17_self_attn_out_proj_bias, 1e-06), kwargs = {})
    %_0_transformer_encoder_17_deepnorm_alpha : [num_users=2] = get_attr[target=0.transformer_encoder.17.deepnorm_alpha]
    %detach_52 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_17_deepnorm_alpha,), kwargs = {})
    %mul_104 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_52, %rms_norm_identity_custom_33), kwargs = {})
    %add_69 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_69, %mul_104), kwargs = {})
    %_0_transformer_encoder_17_norm1_scale : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm1.scale]
    %_0_transformer_encoder_17_norm2_eps_34 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_34 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_69, %_0_transformer_encoder_17_norm1_scale, %_0_transformer_encoder_17_norm2_eps_34, 512, -1.0, False), kwargs = {})
    %_0_transformer_encoder_17_ff_fc1_weight : [num_users=1] = get_attr[target=0.transformer_encoder.17.ff.fc1.weight]
    %linear_epsilon_70 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_34, %_0_transformer_encoder_17_ff_fc1_weight, None, 1e-06), kwargs = {})
    %chunk_17 : [num_users=2] = call_method[target=chunk](args = (%linear_epsilon_70, 2), kwargs = {dim: -1})
    %getitem_250 : [num_users=1] = call_function[target=operator.getitem](args = (%chunk_17, 0), kwargs = {})
    %getitem_251 : [num_users=2] = call_function[target=operator.getitem](args = (%chunk_17, 1), kwargs = {})
    %mul_105 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%getitem_251, %getitem_250), kwargs = {})
    %mul_106 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%mul_105, 1), kwargs = {})
    %neg_17 : [num_users=1] = call_function[target=operator.neg](args = (%getitem_251,), kwargs = {})
    %exp_17 : [num_users=1] = call_function[target=torch.exp](args = (%neg_17,), kwargs = {})
    %_tensor_constant53 : [num_users=1] = get_attr[target=_tensor_constant53]
    %add_70 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%_tensor_constant53, %exp_17), kwargs = {})
    %truediv_35 : [num_users=1] = call_function[target=operator.truediv](args = (%mul_106, %add_70), kwargs = {})
    %_0_transformer_encoder_17_ff_fc2_weight : [num_users=1] = get_attr[target=0.transformer_encoder.17.ff.fc2.weight]
    %linear_epsilon_71 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%truediv_35, %_0_transformer_encoder_17_ff_fc2_weight, None, 1e-06), kwargs = {})
    %detach_53 : [num_users=1] = call_method[target=detach](args = (%_0_transformer_encoder_17_deepnorm_alpha,), kwargs = {})
    %mul_107 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%detach_53, %rms_norm_identity_custom_34), kwargs = {})
    %add_71 : [num_users=1] = call_function[target=lxt.functional.add2](args = (%linear_epsilon_71, %mul_107), kwargs = {})
    %_0_transformer_encoder_17_norm2_scale : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.scale]
    %_0_transformer_encoder_17_norm2_eps_35 : [num_users=1] = get_attr[target=0.transformer_encoder.17.norm2.eps]
    %rms_norm_identity_custom_35 : [num_users=2] = call_function[target=bonito.lxt_folder.RMSNorm.rms_norm_identity_custom](args = (%add_71, %_0_transformer_encoder_17_norm2_scale, %_0_transformer_encoder_17_norm2_eps_35, 512, -1.0, False), kwargs = {})
    %size_126 : [num_users=3] = call_method[target=size](args = (%rms_norm_identity_custom_35,), kwargs = {})
    %getitem_252 : [num_users=1] = call_function[target=operator.getitem](args = (%size_126, 0), kwargs = {})
    %getitem_253 : [num_users=1] = call_function[target=operator.getitem](args = (%size_126, 1), kwargs = {})
    %getitem_254 : [num_users=1] = call_function[target=operator.getitem](args = (%size_126, 2), kwargs = {})
    %_0_upsample_linear_weight : [num_users=1] = get_attr[target=0.upsample.linear.weight]
    %_0_upsample_linear_bias : [num_users=1] = get_attr[target=0.upsample.linear.bias]
    %linear_epsilon_72 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%rms_norm_identity_custom_35, %_0_upsample_linear_weight, %_0_upsample_linear_bias, 1e-06), kwargs = {})
    %mul_108 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (2, %getitem_253), kwargs = {})
    %reshape_18 : [num_users=1] = call_method[target=reshape](args = (%linear_epsilon_72, %getitem_252, %mul_108, %getitem_254), kwargs = {})
    %permute_73 : [num_users=1] = call_method[target=permute](args = (%reshape_18, 1, 0, 2), kwargs = {})
    %_0_crf_linear_weight : [num_users=1] = get_attr[target=0.crf.linear.weight]
    %linear_epsilon_73 : [num_users=1] = call_function[target=lxt.functional.linear_epsilon](args = (%permute_73, %_0_crf_linear_weight, None, 1e-06), kwargs = {})
    %mul_109 : [num_users=1] = call_function[target=lxt.functional.mul2](args = (%linear_epsilon_73, 5.0), kwargs = {})
    %permute_74 : [num_users=1] = call_method[target=permute](args = (%mul_109, 1, 0, 2), kwargs = {})
    %contiguous : [num_users=1] = call_method[target=contiguous](args = (%permute_74,), kwargs = {})
    return contiguous